import{g as ye,y as ke,f as Te,r as n,h as ve,t as Ge,i as je,k as N,p as pe,z as Xe,D as qe,l as be,n as Je,E as Ze,R as Qe,w as et,_ as Se,F as tt,G as st,H as nt,J as at,K as ot,C as Ee,M as rt,N as lt,O as Ie,B as k,P as it,Q as ct,S as dt,T as mt,U as ut,V as pt,s as xt,m as gt,W as ft,X as ht,Y as yt,e as Re,I as Ae,Z as vt,u as jt,c as I,j as e,v as bt,d as Ct,b as Nt,x as wt}from"./index-D0pMv6Rn.js";import{I as St}from"./antd-img-crop.esm-DJUEPohw.js";import{d as xe,f as Ce,t as It,F as Ne,D as $t,M as ge,S as ae,U as kt,R as Tt,a as le}from"./date-D-U2jQqQ.js";import{s as w}from"./index-DCb48Tcc.js";import{C as re,T as Et,R as Rt}from"./index-DgoFLg0m.js";import{S as q}from"./TextArea-o0LrS0kX.js";import{T as At}from"./index-CyhAv3FF.js";import{T as Ue}from"./index-q9NpNCFH.js";import{R as Ut}from"./ArrowLeftOutlined-DjKJJQt4.js";import{R as $e,C as X,F as A,I as _}from"./index-B08V36Mz.js";import{D as Pt}from"./index-BPhzQ6Pc.js";import"./index-R6mv4Hm2.js";const oe=(s,t,a,r,d)=>({background:s,border:`${Te(r.lineWidth)} ${r.lineType} ${t}`,[`${d}-icon`]:{color:a}}),Mt=s=>{const{componentCls:t,motionDurationSlow:a,marginXS:r,marginSM:d,fontSize:m,fontSizeLG:i,lineHeight:l,borderRadiusLG:c,motionEaseInOutCirc:u,withDescriptionIconSize:g,colorText:p,colorTextHeading:o,withDescriptionPadding:x,defaultPadding:h}=s;return{[t]:{...ke(s),position:"relative",display:"flex",alignItems:"center",padding:h,wordWrap:"break-word",borderRadius:c,[`&${t}-rtl`]:{direction:"rtl"},[`${t}-section`]:{flex:1,minWidth:0},[`${t}-icon`]:{marginInlineEnd:r,lineHeight:0},"&-description":{display:"none",fontSize:m,lineHeight:l},"&-title":{color:o},[`&${t}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${a} ${u}, opacity ${a} ${u},
        padding-top ${a} ${u}, padding-bottom ${a} ${u},
        margin-bottom ${a} ${u}`},[`&${t}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}},[`${t}-with-description`]:{alignItems:"flex-start",padding:x,[`${t}-icon`]:{marginInlineEnd:d,fontSize:g,lineHeight:0},[`${t}-title`]:{display:"block",marginBottom:r,color:o,fontSize:i},[`${t}-description`]:{display:"block",color:p}},[`${t}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},zt=s=>{const{componentCls:t,colorSuccess:a,colorSuccessBorder:r,colorSuccessBg:d,colorWarning:m,colorWarningBorder:i,colorWarningBg:l,colorError:c,colorErrorBorder:u,colorErrorBg:g,colorInfo:p,colorInfoBorder:o,colorInfoBg:x}=s;return{[t]:{"&-success":oe(d,r,a,s,t),"&-info":oe(x,o,p,s,t),"&-warning":oe(l,i,m,s,t),"&-error":{...oe(g,u,c,s,t),[`${t}-description > pre`]:{margin:0,padding:0}}}}},Ot=s=>{const{componentCls:t,iconCls:a,motionDurationMid:r,marginXS:d,fontSizeIcon:m,colorIcon:i,colorIconHover:l}=s;return{[t]:{"&-actions":{marginInlineStart:d},[`${t}-close-icon`]:{marginInlineStart:d,padding:0,overflow:"hidden",fontSize:m,lineHeight:Te(m),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${a}-close`]:{color:i,transition:`color ${r}`,"&:hover":{color:l}}},"&-close-text":{color:i,transition:`color ${r}`,"&:hover":{color:l}}}}},Dt=s=>({withDescriptionIconSize:s.fontSizeHeading3,defaultPadding:`${s.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${s.paddingMD}px ${s.paddingContentHorizontalLG}px`}),Lt=ye("Alert",s=>[Mt(s),zt(s),Ot(s)],Dt),_t=s=>{const{icon:t,type:a,className:r,style:d,successIcon:m,infoIcon:i,warningIcon:l,errorIcon:c}=s,u={success:m??n.createElement(Qe,null),info:i??n.createElement(Ze,null),error:c??n.createElement(Je,null),warning:l??n.createElement(be,null)};return n.createElement("span",{className:r,style:d},t??u[a])},Ht=s=>{const{isClosable:t,prefixCls:a,closeIcon:r,handleClose:d,ariaProps:m,className:i,style:l}=s,c=r===!0||r===void 0?n.createElement(et,null):r;return t?n.createElement("button",{type:"button",onClick:d,className:N(`${a}-close-icon`,i),tabIndex:0,style:l,...m},c):null},Pe=n.forwardRef((s,t)=>{const{description:a,prefixCls:r,message:d,title:m,banner:i,className:l,rootClassName:c,style:u,onMouseEnter:g,onMouseLeave:p,onClick:o,afterClose:x,showIcon:h,closable:f,closeText:b,closeIcon:y,action:v,id:j,styles:U,classNames:J,...Z}=s,V=m??d,[W,Y]=n.useState(!1),D=n.useRef(null);n.useImperativeHandle(t,()=>({nativeElement:D.current}));const{getPrefixCls:Q,direction:S,closable:T,closeIcon:G,className:H,style:P,classNames:$,styles:M,successIcon:ee,infoIcon:E,warningIcon:te,errorIcon:ie}=ve("alert"),C=Q("alert",r),[ce,ne]=Lt(C),{onClose:de,afterClose:Le}=f&&typeof f=="object"?f:{},_e=L=>{Y(!0),(de??s.onClose)?.(L)},me=n.useMemo(()=>s.type!==void 0?s.type:i?"warning":"info",[s.type,i]),we=n.useMemo(()=>typeof f=="object"&&f.closeIcon||b?!0:typeof f=="boolean"?f:y!==!1&&Ge(y)?!0:!!T,[b,y,f,T]),ue=i&&h===void 0?!0:h,He={...s,prefixCls:C,type:me,showIcon:ue,closable:we},[B,F]=je([$,J],[M,U],{props:He}),Be=N(C,`${C}-${me}`,{[`${C}-with-description`]:!!a,[`${C}-no-icon`]:!ue,[`${C}-banner`]:!!i,[`${C}-rtl`]:S==="rtl"},H,l,c,B.root,ne,ce),Fe=pe(Z,{aria:!0,data:!0}),Ke=n.useMemo(()=>typeof f=="object"&&f.closeIcon?f.closeIcon:b||(y!==void 0?y:typeof T=="object"&&T.closeIcon?T.closeIcon:G),[y,f,T,b,G]),Ve=n.useMemo(()=>{const L=f??T;return typeof L=="object"?pe(L,{data:!0,aria:!0}):{}},[f,T]);return n.createElement(Xe,{visible:!W,motionName:`${C}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:L=>({maxHeight:L.offsetHeight}),onLeaveEnd:Le??x},({className:L,style:We},Ye)=>n.createElement("div",{id:j,ref:qe(D,Ye),"data-show":!W,className:N(Be,L),style:{...F.root,...P,...u,...We},onMouseEnter:g,onMouseLeave:p,onClick:o,role:"alert",...Fe},ue?n.createElement(_t,{className:N(`${C}-icon`,B.icon),style:F.icon,description:a,icon:s.icon,prefixCls:C,type:me,successIcon:ee,infoIcon:E,warningIcon:te,errorIcon:ie}):null,n.createElement("div",{className:N(`${C}-section`,B.section),style:F.section},V?n.createElement("div",{className:N(`${C}-title`,B.title),style:F.title},V):null,a?n.createElement("div",{className:N(`${C}-description`,B.description),style:F.description},a):null),v?n.createElement("div",{className:N(`${C}-actions`,B.actions),style:F.actions},v):null,n.createElement(Ht,{className:B.close,style:F.close,isClosable:we,prefixCls:C,closeIcon:Ke,handleClose:_e,ariaProps:Ve})))});function Bt(s,t,a){return t=Se(t),tt(s,st()?Reflect.construct(t,a||[],Se(s).constructor):t.apply(s,a))}let Ft=(function(s){function t(){var a;return ot(this,t),a=Bt(this,t,arguments),a.state={error:void 0,info:{componentStack:""}},a}return nt(t,s),at(t,[{key:"componentDidCatch",value:function(r,d){this.setState({error:r,info:d})}},{key:"render",value:function(){const{message:r,title:d,description:m,id:i,children:l}=this.props,{error:c,info:u}=this.state,g=d??r,p=u?.componentStack||null,o=typeof g>"u"?(c||"").toString():g,x=typeof m>"u"?p:m;return c?n.createElement(Pe,{id:i,type:"error",title:o,description:n.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},x)}):l}}])})(n.Component);const Me=Pe;Me.ErrorBoundary=Ft;const Kt=s=>{const{componentCls:t,iconCls:a,antCls:r,zIndexPopup:d,colorText:m,colorWarning:i,marginXXS:l,marginXS:c,fontSize:u,fontWeightStrong:g,colorTextHeading:p}=s;return{[t]:{zIndex:d,[`&${r}-popover`]:{fontSize:u},[`${t}-message`]:{marginBottom:c,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${t}-message-icon ${a}`]:{color:i,fontSize:u,lineHeight:1,marginInlineEnd:c},[`${t}-title`]:{fontWeight:g,color:p,"&:only-child":{fontWeight:"normal"}},[`${t}-description`]:{marginTop:l,color:m}},[`${t}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:c}}}}},Vt=s=>{const{zIndexPopupBase:t}=s;return{zIndexPopup:t+60}},ze=ye("Popconfirm",s=>Kt(s),Vt,{resetStyle:!1}),Oe=s=>{const{prefixCls:t,okButtonProps:a,cancelButtonProps:r,title:d,description:m,cancelText:i,okText:l,okType:c="primary",icon:u=n.createElement(be,null),showCancel:g=!0,close:p,onConfirm:o,onCancel:x,onPopupClick:h,classNames:f,styles:b}=s,{getPrefixCls:y}=n.useContext(Ee),[v]=rt("Popconfirm",lt.Popconfirm),j=Ie(d),U=Ie(m);return n.createElement("div",{className:`${t}-inner-content`,onClick:h},n.createElement("div",{className:`${t}-message`},u&&n.createElement("span",{className:`${t}-message-icon`},u),n.createElement("div",{className:`${t}-message-text`},j&&n.createElement("div",{className:N(`${t}-title`,f?.title),style:b?.title},j),U&&n.createElement("div",{className:N(`${t}-description`,f?.content),style:b?.content},U))),n.createElement("div",{className:`${t}-buttons`},g&&n.createElement(k,{onClick:x,size:"small",...r},i||v?.cancelText),n.createElement(it,{buttonProps:{size:"small",...ct(c),...a},actionFn:o,close:p,prefixCls:y("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},l||v?.okText)))},Wt=s=>{const{prefixCls:t,placement:a,className:r,style:d,...m}=s,{getPrefixCls:i}=n.useContext(Ee),l=i("popconfirm",t);return ze(l),n.createElement(dt,{placement:a,className:N(l,r),style:d,content:n.createElement(Oe,{prefixCls:l,...m})})},Yt=n.forwardRef((s,t)=>{const{prefixCls:a,placement:r="top",trigger:d,okType:m="primary",icon:i=n.createElement(be,null),children:l,overlayClassName:c,onOpenChange:u,overlayStyle:g,styles:p,arrow:o,classNames:x,...h}=s,{getPrefixCls:f,className:b,style:y,classNames:v,styles:j,arrow:U,trigger:J}=ve("popconfirm"),[Z,V]=mt(s.defaultOpen??!1,s.open),W=ut(o,U),Y=d||J||"click",D=E=>{V(E),u?.(E)},Q=()=>{D(!1)},S=E=>s.onConfirm?.call(void 0,E),T=E=>{D(!1),s.onCancel?.call(void 0,E)},G=E=>{const{disabled:te=!1}=s;te||D(E)},H=f("popconfirm",a),P={...s,placement:r,trigger:Y,okType:m,overlayStyle:g,styles:p,classNames:x},[$,M]=je([v,x],[j,p],{props:P}),ee=N(H,b,c,$.root);return ze(H),n.createElement(pt,{arrow:W,...xt(h,["title"]),trigger:Y,placement:r,onOpenChange:G,open:Z,ref:t,classNames:{root:ee,container:$.container,arrow:$.arrow},styles:{root:{...y,...M.root,...g},container:M.container,arrow:M.arrow},content:n.createElement(Oe,{okType:m,icon:i,...s,prefixCls:H,close:Q,onConfirm:S,onCancel:T,classNames:$,styles:M}),"data-popover-inject":!0},l)}),se=Yt;se._InternalPanelDoNotUseOrYouWillBeFired=Wt;const Gt=s=>{const{value:t,formatter:a,precision:r,decimalSeparator:d,groupSeparator:m="",prefixCls:i}=s;let l;if(typeof a=="function")l=a(t);else{const c=String(t),u=c.match(/^(-?)(\d*)(\.(\d+))?$/);if(!u||c==="-")l=c;else{const g=u[1];let p=u[2]||"0",o=u[4]||"";p=p.replace(/\B(?=(\d{3})+(?!\d))/g,m),typeof r=="number"&&(o=o.padEnd(r,"0").slice(0,r>0?r:0)),o&&(o=`${d}${o}`),l=[n.createElement("span",{key:"int",className:`${i}-content-value-int`},g,p),o&&n.createElement("span",{key:"decimal",className:`${i}-content-value-decimal`},o)]}}return n.createElement("span",{className:`${i}-content-value`},l)},Xt=s=>{const{componentCls:t,marginXXS:a,padding:r,colorTextDescription:d,titleFontSize:m,colorTextHeading:i,contentFontSize:l,fontFamily:c}=s;return{[t]:{...ke(s),[`${t}-header`]:{paddingBottom:a,[`${t}-title`]:{color:d,fontSize:m}},[`${t}-skeleton`]:{paddingTop:r},[`${t}-content`]:{color:i,fontSize:l,fontFamily:c,[`${t}-content-value`]:{display:"inline-block",direction:"ltr"},[`${t}-content-prefix, ${t}-content-suffix`]:{display:"inline-block"},[`${t}-content-prefix`]:{marginInlineEnd:a},[`${t}-content-suffix`]:{marginInlineStart:a}}}}},qt=s=>{const{fontSizeHeading3:t,fontSize:a}=s;return{titleFontSize:a,contentFontSize:t}},Jt=ye("Statistic",s=>{const t=gt(s,{});return Xt(t)},qt),K=n.forwardRef((s,t)=>{const{prefixCls:a,className:r,rootClassName:d,style:m,valueStyle:i,value:l=0,title:c,valueRender:u,prefix:g,suffix:p,loading:o=!1,formatter:x,precision:h,decimalSeparator:f=".",groupSeparator:b=",",onMouseEnter:y,onMouseLeave:v,styles:j,classNames:U,...J}=s,{getPrefixCls:Z,direction:V,className:W,style:Y,classNames:D,styles:Q}=ve("statistic"),S=Z("statistic",a),[T,G]=Jt(S),H={...s,decimalSeparator:f,groupSeparator:b,loading:o,value:l},[P,$]=je([D,U],[Q,j],{props:H}),M=n.createElement(Gt,{decimalSeparator:f,groupSeparator:b,prefixCls:S,formatter:x,precision:h,value:l}),ee=N(S,{[`${S}-rtl`]:V==="rtl"},W,r,d,P.root,T,G),E=N(`${S}-header`,P.header),te=N(`${S}-title`,P.title),ie=N(`${S}-content`,P.content),C=N(`${S}-content-prefix`,P.prefix),ce=N(`${S}-content-suffix`,P.suffix),ne=n.useRef(null);n.useImperativeHandle(t,()=>({nativeElement:ne.current}));const de=pe(J,{aria:!0,data:!0});return n.createElement("div",{...de,className:ee,style:{...$.root,...Y,...m},ref:ne,onMouseEnter:y,onMouseLeave:v},c&&n.createElement("div",{className:E,style:$.header},n.createElement("div",{className:te,style:$.title},c)),n.createElement(ft,{paragraph:!1,loading:o,className:`${S}-skeleton`,active:!0},n.createElement("div",{className:ie,style:{...i,...$.content}},g&&n.createElement("span",{className:C,style:$.prefix},g),u?u(M):M,p&&n.createElement("span",{className:ce,style:$.suffix},p))))}),Zt=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Qt(s,t){let a=s;const r=/\[[^\]]*]/g,d=(t.match(r)||[]).map(c=>c.slice(1,-1)),m=t.replace(r,"[]"),i=Zt.reduce((c,[u,g])=>{if(c.includes(u)){const p=Math.floor(a/g);return a-=p*g,c.replace(new RegExp(`${u}+`,"g"),o=>{const x=o.length;return p.toString().padStart(x,"0")})}return c},m);let l=0;return i.replace(r,()=>{const c=d[l];return l+=1,c})}function es(s,t,a){const{format:r=""}=t,d=new Date(s).getTime(),m=Date.now(),i=Math.max(a?d-m:m-d,0);return Qt(i,r)}const ts=1e3/60;function ss(s){return new Date(s).getTime()}const De=s=>{const{value:t,format:a="HH:mm:ss",onChange:r,onFinish:d,type:m,...i}=s,l=m==="countdown",[c,u]=n.useState(null),g=ht(()=>{const x=Date.now(),h=ss(t);u({});const f=l?h-x:x-h;return r?.(f),l&&h<x?(d?.(),!1):!0});n.useEffect(()=>{let x;const h=()=>{g()||window.clearInterval(x)},f=()=>{x=window.setInterval(h,ts)},b=()=>{window.clearInterval(x)};return f(),()=>{b()}},[t,l]),n.useEffect(()=>{u({})},[]);const p=(x,h)=>c?es(x,{...h,format:a},l):"-",o=x=>yt(x,{title:void 0});return n.createElement(K,{...i,value:t,valueRender:o,formatter:p})},ns=s=>n.createElement(De,{...s,type:"countdown"}),as=n.memo(ns);K.Timer=De;K.Countdown=as;const os=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],rs=Re("ban",os);const ls=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],is=Re("copy",ls);var cs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};function fe(){return fe=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}return s},fe.apply(this,arguments)}const ds=(s,t)=>n.createElement(Ae,fe({},s,{ref:t,icon:cs})),ms=n.forwardRef(ds);var us={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 642.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 505 759.6 431.7 759.6 349c0-137-110.8-248-247.5-248S264.7 212 264.7 349c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 888.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 628.2 432.2 597 512.2 597c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 521c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 349c0-45.9 17.9-89.1 50.3-121.6S466.3 177 512.2 177s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 349c0 45.9-17.9 89.1-50.3 121.6C601.1 503.1 558 521 512.2 521zM880 759h-84v-84c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v84h-84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h84v84c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-84h84c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-add",theme:"outlined"};function he(){return he=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}return s},he.apply(this,arguments)}const ps=(s,t)=>n.createElement(Ae,he({},s,{ref:t,icon:us})),xs=n.forwardRef(ps),{Title:z,Text:O,Paragraph:R}=At;function As(){const{appId:s}=vt(),t=jt(),[a,r]=n.useState(null);n.useEffect(()=>{s&&d()},[s]);const d=async()=>{try{const{data:i}=await I.get(`/apps/details?id=${s}`);r(i.data)}catch{w.error("Could not load app details"),t("/dashboard")}};if(!a)return e.jsx(bt,{});const m=[{key:"stats",label:"Analytics",children:e.jsx(vs,{app:a})},{key:"keys",label:"API Keys",children:e.jsx(gs,{app:a})},{key:"members",label:"Members",children:e.jsx(fs,{app:a})},{key:"help",label:"Integration Guide",children:e.jsx(ys,{app:a})},{key:"settings",label:"Settings",children:e.jsx(hs,{app:a,onUpdate:d,onDelete:()=>t("/dashboard")})}];return e.jsxs(re,{className:"max-w-5xl w-full shadow-xl",title:"Manage Application",extra:e.jsx(k,{icon:e.jsx(Ut,{}),onClick:()=>t(-1),children:"Back"}),children:[e.jsxs(q,{size:10,align:"center",className:"mb-3",children:[e.jsx(Ct,{size:48,src:a.logoUrl,children:a.name.charAt(0).toUpperCase()}),e.jsx(z,{level:3,style:{marginBottom:0},children:a.name}),e.jsx(Ue,{color:"blue",children:a.role})]}),a.suspendUntil&&xe(a.suspendUntil).isAfter(xe())&&e.jsx(Me,{type:"error",title:"This app is suspended until "+Ce(a.suspendUntil)}),e.jsx(Et,{defaultActiveKey:"stats",items:m})]})}function gs({app:s}){const[t,a]=n.useState([]),[r,d]=n.useState(!1),[m,i]=n.useState(!1),[l,c]=n.useState(""),[u,g]=n.useState(!1),[p,o]=n.useState("");n.useEffect(()=>{x()},[s.id]);const x=async()=>{d(!0);try{const{data:y}=await I.get(`/apps/keys?id=${s.id}`);a(y.data||[])}catch{}finally{d(!1)}},h=async()=>{try{const{data:y}=await I.post("/apps/keys/create",{appId:s.id,name:l});o(y.data.key),i(!1),g(!0),c(""),x()}catch{w.error("Failed to create API key")}},f=async y=>{try{await I.post("/apps/keys/delete",{appId:s.id,keyId:y}),w.success("Key deleted"),x()}catch{w.error("Could not delete key")}},b=[{title:"Name",dataIndex:"name",key:"name",render:y=>y||e.jsx(O,{type:"secondary",children:"Unnamed"})},{title:"ID",dataIndex:"id",key:"id"},{title:"Created At",dataIndex:"createdAt",key:"createdAt",render:y=>Ce(y)},{title:"Action",key:"action",render:(y,v)=>e.jsx(se,{title:"Delete this key?",onConfirm:()=>f(v.id),okText:"Yes",cancelText:"No",children:e.jsx(k,{danger:!0,size:"small",icon:e.jsx(le,{}),children:"Delete"})})}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(O,{children:"Manage your API keys for accessing the service."}),s.role!=="external"&&e.jsx(k,{type:"primary",icon:e.jsx(Rt,{}),onClick:()=>i(!0),children:"Create New Key"})]}),e.jsx(Ne,{dataSource:t,columns:b,rowKey:"id",loading:r,pagination:!1}),e.jsx(ge,{title:"Create New API Key",open:m,onCancel:()=>i(!1),onOk:h,okText:"Create",children:e.jsx(A,{layout:"vertical",children:e.jsx(A.Item,{label:"Key Name (Optional)",children:e.jsx(_,{placeholder:"e.g. Production Key",value:l,onChange:y=>c(y.target.value)})})})}),e.jsx(ge,{title:"API Key Created",open:u,onCancel:()=>g(!1),footer:[e.jsx(k,{type:"primary",onClick:()=>g(!1),children:"Done"},"close")],children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(O,{type:"secondary",children:"Copy this key now. You won't see it again."}),e.jsxs(q.Compact,{style:{width:"100%"},children:[e.jsx(_,{value:p,readOnly:!0}),e.jsx(k,{onClick:()=>{navigator.clipboard.writeText(p),w.success("Copied to clipboard")},children:e.jsx(is,{size:16})})]})]})})]})}function fs({app:s}){const[t,a]=n.useState([]),[r,d]=n.useState(!1),[m,i]=n.useState(!1),[l,c]=n.useState(""),[u,g]=n.useState("admin"),{profile:p}=Nt();n.useEffect(()=>{o()},[s.id]);const o=async()=>{d(!0);try{const{data:v}=await I.get(`/apps/members?id=${s.id}`);a(v.data||[])}catch{}finally{d(!1)}},x=async()=>{try{await I.post("/apps/members/add",{appId:s.id,username:l,role:u}),w.success("Member added"),i(!1),c(""),o()}catch(v){const j=v.response?.data?.message||"Failed to add member";w.error(j)}},h=async v=>{try{await I.post("/apps/members/remove",{appId:s.id,username:v}),w.success("Member removed"),o()}catch{w.error("Failed to remove member")}},f=async(v,j)=>{try{await I.post("/apps/members/role",{appId:s.id,username:v,role:j}),w.success("Role updated"),o()}catch{w.error("Failed to update role")}},b=[{label:"Admin",value:"admin"},{label:"Root",value:"root"}],y=[{title:"Username",dataIndex:"username",key:"username"},{title:"Role",dataIndex:"role",key:"role",render:v=>e.jsx(Ue,{color:v==="root"?"gold":"blue",children:v})},{title:"Action",key:"action",render:(v,j)=>j.username===p?.username?e.jsx(q,{children:e.jsx(se,{title:"Remove yourself? You'll lose access to this app!",onConfirm:()=>h(j.username),okText:"Yes",cancelText:"No",children:e.jsx(k,{danger:!0,size:"small",icon:e.jsx(le,{}),children:"Leave"})})}):s.role!=="root"?e.jsx(rs,{size:18}):e.jsxs(q,{children:[e.jsx(ae,{value:j.role,onChange:U=>f(j.username,U),options:b,size:"small",className:"w-20"}),e.jsx(se,{title:`Remove ${j.username} from this app?`,onConfirm:()=>h(j.username),okText:"Yes",cancelText:"No",children:e.jsx(k,{danger:!0,size:"small",icon:e.jsx(le,{})})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(O,{children:"Manage team members and their access levels."}),s.role==="root"&&e.jsx(k,{type:"primary",icon:e.jsx(xs,{}),onClick:()=>i(!0),children:"Add Member"})]}),e.jsx(Ne,{dataSource:t,columns:y,rowKey:"username",loading:r,pagination:!1}),e.jsx(ge,{title:"Add New Member",open:m,onCancel:()=>i(!1),onOk:x,okText:"Add",children:e.jsxs(A,{layout:"vertical",children:[e.jsx(A.Item,{label:"Username",required:!0,children:e.jsx(_,{value:l,onChange:v=>c(v.target.value),placeholder:"Username"})}),e.jsx(A.Item,{label:"Role",required:!0,children:e.jsxs(ae,{value:u,onChange:g,children:[e.jsx(ae.Option,{value:"admin",children:"Admin"}),e.jsx(ae.Option,{value:"root",children:"Root"})]})})]})})]})}function hs({app:s,onUpdate:t,onDelete:a}){const[r]=A.useForm(),[d,m]=n.useState(!1),[i,l]=n.useState(null);n.useEffect(()=>{r.setFieldsValue({name:s.name,description:s.description,logoUrl:s.logoUrl}),l(null)},[s]);const c=async p=>{m(!0);try{if(i){const o=new FormData;o.append("appId",s.id),o.append("name",p.name),o.append("description",p.description||""),o.append("logoUrl",p.logoUrl||""),o.append("file",i),await I.post("/apps/update",o,{headers:{"Content-Type":"multipart/form-data"}})}else await I.post("/apps/update",{appId:s.id,name:p.name,description:p.description,logoUrl:p.logoUrl});w.success("App updated"),t(),l(null)}catch(o){console.error(o),w.error("Failed to update app")}finally{m(!1)}},u=async()=>{try{await I.post("/apps/delete",{appId:s.id}),w.success("App deleted"),a()}catch(p){const o=p.response?.data?.message||"Failed to delete app";w.error(o)}},g=s.role==="root";return e.jsxs("div",{className:"max-w-3xl",children:[e.jsx(z,{level:4,children:"General Settings"}),e.jsxs(A,{form:r,layout:"vertical",onFinish:c,children:[e.jsx(A.Item,{label:"App Name",name:"name",rules:[{required:!0,message:"Please input app name!"}],children:e.jsx(_,{})}),e.jsx(A.Item,{label:"Description",name:"description",children:e.jsx(_.TextArea,{rows:4})}),e.jsx(A.Item,{label:"Logo URL",children:e.jsxs(q.Compact,{style:{width:"100%"},children:[e.jsx(A.Item,{name:"logoUrl",noStyle:!0,children:e.jsx(_,{placeholder:"https://example.com/logo.png"})}),e.jsx(St,{rotationSlider:!0,children:e.jsx(kt,{showUploadList:!1,customRequest:({file:p,onSuccess:o})=>{const x=p;l(x);const h=URL.createObjectURL(x);r.setFieldValue("logoUrl",h),w.success("Logo selected. Click Save to apply."),o?.("ok")},children:e.jsx(k,{icon:e.jsx(Tt,{}),children:"Select"})})})]})}),e.jsx(A.Item,{children:e.jsx(k,{type:"primary",htmlType:"submit",icon:e.jsx(ms,{}),loading:d,children:"Save Changes"})})]}),g&&e.jsxs(e.Fragment,{children:[e.jsx(Pt,{}),e.jsxs("div",{className:"border border-red-200 dark:border-red-900 p-4 rounded-lg bg-red-50 dark:bg-red-900/20",children:[e.jsx(z,{level:5,type:"danger",children:"Danger Zone"}),e.jsx(R,{children:"Deleting this application will remove all associated data, including API keys and member associations. This action cannot be undone."}),e.jsx(se,{title:"Are you sure you want to delete this app?",description:"This action cannot be undone.",onConfirm:u,okText:"Yes, delete it",okType:"danger",cancelText:"Cancel",children:e.jsx(k,{type:"primary",danger:!0,icon:e.jsx(le,{}),children:"Delete Application"})})]})]})]})}function ys({app:s}){const t=wt.API_URL,a=window.location.origin,[r,d]=n.useState(""),[m,i]=n.useState(""),l=async()=>{try{const{data:c}=await I.post("/sso/init",{appId:s.id},{headers:{"X-Api-Key":m}}),u=c.data.loginUrl+(r?`&from=${encodeURIComponent(r)}`:"");w.success("Test session created"),window.open(u,"_blank")}catch(c){const u=c,g=u.response?.status,p=u.response?.data?.message;return console.error("Failed to create test session",u),w.error(p+` (Status: ${g})`),null}};return e.jsxs("div",{className:"max-w-3xl space-y-8",children:[e.jsxs("div",{children:[e.jsx(z,{level:3,children:"Mirpass SSO Integration Guide"}),e.jsx(R,{children:"Integrate secure Single Sign-On (SSO) into your application using Mirpass. Initiate login sessions with your App ID."}),e.jsxs(q,{orientation:"vertical",className:"w-full max-w-xl",children:[e.jsx(_,{placeholder:"API Key",value:m,onChange:c=>i(c.target.value)}),e.jsx(_,{placeholder:"Redirect URL (Optional)",value:r,onChange:c=>d(c.target.value)}),e.jsx(k,{onClick:l,type:"primary",disabled:!m,children:"Create test session"})]})]}),e.jsxs("div",{children:[e.jsx(z,{level:4,children:"1. Initiate Login Session"}),e.jsx(R,{children:'When a user clicks "Login with Mirpass" on your site, make a server-to-server request to get a session ID.'}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"POST"})," ",t,"/sso/init",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"Content-Type:"})," application/json",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"X-Api-Key:"})," YOUR_API_KEY",e.jsx("br",{}),e.jsx("br",{}),`{ "appId": "${s.id}" }`]}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 p-3 rounded text-sm text-gray-600 dark:text-gray-300 font-mono",children:`{
  "status": "success",
  "data": {
    "sessionId": "sess_abc123...",
    "pollSecret": "secret_xyz...",
    "loginUrl": "${a}/login?sso=sess_abc123..." 
  }
}`})]}),e.jsxs("div",{children:[e.jsx(z,{level:4,children:"2. Redirect User"}),e.jsx(R,{children:"Redirect the user's browser to the returned `login_url` (appended to the Mirpass frontend domain). You can optionally include a `from` parameter to redirect the user back to your site after login."}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 p-3 rounded text-blue-600 dark:text-blue-400 font-mono text-sm break-all",children:[a,"/login?sso=sess_abc123...&from=https://yoursite.com/callback"]}),e.jsxs(R,{className:"mt-2 text-sm",children:["After successful authorization, the user will be redirected to:",e.jsx("br",{}),e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 p-1 rounded",children:"https://yoursite.com/callback?code=AUTH_CODE_123..."})]})]}),e.jsxs("div",{children:[e.jsx(z,{level:4,children:"3. Poll for Status (If not redirecting)"}),e.jsx(R,{children:"Use the `pollSecret` returned in step 1 to securely poll the status. Note: If the user is redirected (Step 2), the auth code will be delivered there, and subsequent polling will not satisfy the code delivery."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-green-400",children:"GET"})," ",t,"/sso/poll?sessionId=sess_abc123...&secret=secret_xyz..."]}),e.jsx(R,{className:"mt-2 text-sm text-gray-500",children:"Response (Pending):"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono mb-2",children:'{ "status": "pending" }'}),e.jsx(R,{className:"text-sm text-gray-500",children:"Response (Confirmed):"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono",children:`{
  "status": "confirmed",
  "authCode": "AUTH_CODE_123..."
}`})]}),e.jsxs("div",{children:[e.jsx(z,{level:4,children:"4. Exchange Code for Token"}),e.jsx(R,{children:"Once you receive the `authCode` (via redirect or polling), exchange it for a user access token. The code is valid for 10 minutes and can be used only once."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"POST"})," ",t,"/sso/token",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"Content-Type:"})," application/json",e.jsx("br",{}),e.jsx("br",{}),'{ "code": "AUTH_CODE_123..." }']}),e.jsx(R,{className:"mt-2 text-sm text-gray-500",children:"Response:"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono",children:`{
  "token": "eyJhbGciOiJIUzI1Ni...",
  "username": "john_doe"
}`})]}),e.jsxs("div",{children:[e.jsx(z,{level:4,children:"5. Verify Token"}),e.jsx(R,{children:"To ensure the token is valid and get user claims, verify it against our server."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"POST"})," ",t,"/sso/verify",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"Content-Type:"})," application/json",e.jsx("br",{}),e.jsx("br",{}),'{ "token": "eyJhbGciOiJIUzI1Ni..." }']}),e.jsx(R,{className:"mt-2 text-sm text-gray-500",children:"Response:"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono"})]})]})}function vs({app:s}){const[t,a]=n.useState(null),[r,d]=n.useState([]),[m,i]=n.useState(!1),[l,c]=n.useState(null);n.useEffect(()=>{u()},[s.id]),n.useEffect(()=>{g(l)},[l,s.id]);const u=async()=>{i(!0);try{const{data:o}=await I.get(`/apps/stats?id=${s.id}`);a(o.data)}catch{}finally{i(!1)}},g=async o=>{let x=`/apps/history?id=${s.id}`;o&&(x+=`&date=${It(o)}&offset=${o.utcOffset()}`);try{const{data:h}=await I.get(x);d(h.data||[])}catch{}},p=n.useMemo(()=>t?.daily?t.daily:[],[t]);return m&&!t?e.jsx("div",{className:"p-4",children:"Loading stats..."}):t?e.jsxs("div",{children:[e.jsx(re,{title:"Summary",className:"bg-white/90",style:{margin:"10px 0"},children:e.jsxs($e,{gutter:16,className:"text-center",children:[e.jsx(X,{xs:12,sm:6,children:e.jsx(K,{title:"Total Users",value:t.totalUsers})}),e.jsx(X,{xs:12,sm:6,children:e.jsx(K,{title:"Total Logins",value:t.totalLogins})}),e.jsx(X,{xs:12,sm:6,children:e.jsx(K,{title:"Active (24h)",value:t.activeUsers24h})}),e.jsx(X,{xs:12,sm:6,children:e.jsx(K,{title:"New (24h)",value:t.newUsers24h})})]})}),e.jsxs($e,{gutter:16,children:[e.jsx(X,{xs:24,xl:12,children:e.jsx(re,{title:"Traffic (Last 7 Days)",style:{margin:"10px 0"},children:e.jsxs("div",{children:[e.jsx("div",{className:"flex items-end justify-between h-56 gap-2 px-2",children:p.map(o=>{const x=Math.max(...p.map(f=>Math.max(f.logins,f.activeUsers,f.newUsers))),h=x>0?160/x:0;return e.jsxs("div",{className:"flex flex-col items-center gap-2 group w-full overflow-hidden",children:[e.jsxs("div",{className:"flex gap-1 items-end h-[160px] w-full justify-center relative",children:[e.jsx("div",{className:"bg-indigo-400 dark:bg-indigo-600 w-3 rounded-t transition-all hover:bg-indigo-300",style:{height:`${Math.max(o.logins*h,4)}px`},title:`Logins: ${o.logins}`}),e.jsx("div",{className:"bg-emerald-400 dark:bg-emerald-600 w-3 rounded-t transition-all hover:bg-emerald-300",style:{height:`${Math.max(o.activeUsers*h,4)}px`},title:`Active Users: ${o.activeUsers}`}),e.jsx("div",{className:"bg-sky-400 dark:bg-sky-600 w-3 rounded-t transition-all hover:bg-sky-300",style:{height:`${Math.max(o.newUsers*h,4)}px`},title:`New Users: ${o.newUsers}`})]}),e.jsx("div",{className:"text-xs text-gray-500 whitespace-nowrap transform -rotate-45 origin-left mt-6 pl-4",children:xe.utc(o.date).format("MM-DD")})]},o.date)})}),e.jsxs("div",{className:"flex justify-center flex-wrap gap-x-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-indigo-400 rounded"}),e.jsx(O,{type:"secondary",className:"text-xs",children:"Logins"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-emerald-400 rounded"}),e.jsx(O,{type:"secondary",className:"text-xs",children:"Active Users"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-sky-400 rounded"}),e.jsx(O,{type:"secondary",className:"text-xs",children:"New Users"})]})]})]})})}),e.jsx(X,{xs:24,xl:12,children:e.jsxs(re,{title:"Login History",style:{margin:"10px 0"},extra:e.jsx($t,{value:l,onChange:o=>c(o?o.utc():null),allowClear:!0}),children:[l&&e.jsxs(O,{children:[r.length," activities found"]}),e.jsx(Ne,{dataSource:r,size:"small",pagination:{pageSize:10},locale:{emptyText:"No activity on selected date"},columns:[{title:"User",dataIndex:"user",key:"user",render:o=>o?e.jsx("span",{className:"flex items-center gap-2",children:o}):e.jsx(O,{type:"secondary",children:"Unknown"})},{title:"Time",dataIndex:"time",key:"time",render:o=>Ce(o)}],rowKey:o=>o.time+(o.user||"unknown")})]})})]})]}):e.jsx("div",{className:"p-4",children:"No stats available."})}export{As as default};
