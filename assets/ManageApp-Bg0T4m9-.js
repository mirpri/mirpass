import{g as me,J as Ie,h as B,r as a,i as he,F as st,k as ge,l as $,p as ve,K as at,N as rt,R as Ne,n as ot,O as it,o as lt,G as ct,Q as ze,S as dt,T as ut,U as mt,V as ht,W as gt,x as _e,X as pt,Y as xt,Z as Ae,B as U,$ as ft,a0 as yt,a1 as vt,a2 as ke,a3 as bt,a4 as jt,E as St,I as Ee,m as De,a5 as wt,a6 as Ct,a7 as $t,a8 as Ue,a9 as It,aa as Nt,ab as kt,ac as Et,ad as Tt,ae as Rt,d as Mt,af as zt,u as At,c as T,A as se,j as e,e as Ut,f as Pt,b as _t,H as be}from"./index-C1qiHovD.js";import{F as Dt,I as Ot}from"./FailedView-Dy4_m9dM.js";import{d as je,f as Te,t as Ht,F as Re,D as Ft,M as Oe,S as le,U as Lt,R as Bt,a as ue}from"./date-c0-W7nDv.js";import{g as ce,s as qt}from"./crypto-B9Mf35RN.js";import{C as ae,T as He,R as Wt}from"./index-Cd4gSAcP.js";import{S as W}from"./TextArea-TCOLGvF0.js";import{T as Vt}from"./index-DsEsYiwj.js";import{T as Fe}from"./index-CGrJ8JwI.js";import{R as Xt}from"./ArrowLeftOutlined-ChteN7Xy.js";import{R as Pe,C as ne,F as _,I as F}from"./index-BpHuEX1Q.js";import{D as Gt}from"./index-u3CBKLRX.js";import"./index-BHN4cF8Q.js";const de=(t,n,s,r,c)=>({background:t,border:`${B(r.lineWidth)} ${r.lineType} ${n}`,[`${c}-icon`]:{color:s}}),Kt=t=>{const{componentCls:n,motionDurationSlow:s,marginXS:r,marginSM:c,fontSize:d,fontSizeLG:m,lineHeight:o,borderRadiusLG:i,motionEaseInOutCirc:u,withDescriptionIconSize:p,colorText:g,colorTextHeading:l,withDescriptionPadding:h,defaultPadding:f}=t;return{[n]:{...Ie(t),position:"relative",display:"flex",alignItems:"center",padding:f,wordWrap:"break-word",borderRadius:i,[`&${n}-rtl`]:{direction:"rtl"},[`${n}-section`]:{flex:1,minWidth:0},[`${n}-icon`]:{marginInlineEnd:r,lineHeight:0},"&-description":{display:"none",fontSize:d,lineHeight:o},"&-title":{color:l},[`&${n}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${s} ${u}, opacity ${s} ${u},
        padding-top ${s} ${u}, padding-bottom ${s} ${u},
        margin-bottom ${s} ${u}`},[`&${n}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}},[`${n}-with-description`]:{alignItems:"flex-start",padding:h,[`${n}-icon`]:{marginInlineEnd:c,fontSize:p,lineHeight:0},[`${n}-title`]:{display:"block",marginBottom:r,color:l,fontSize:m},[`${n}-description`]:{display:"block",color:g}},[`${n}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},Yt=t=>{const{componentCls:n,colorSuccess:s,colorSuccessBorder:r,colorSuccessBg:c,colorWarning:d,colorWarningBorder:m,colorWarningBg:o,colorError:i,colorErrorBorder:u,colorErrorBg:p,colorInfo:g,colorInfoBorder:l,colorInfoBg:h}=t;return{[n]:{"&-success":de(c,r,s,t,n),"&-info":de(h,l,g,t,n),"&-warning":de(o,m,d,t,n),"&-error":{...de(p,u,i,t,n),[`${n}-description > pre`]:{margin:0,padding:0}}}}},Jt=t=>{const{componentCls:n,iconCls:s,motionDurationMid:r,marginXS:c,fontSizeIcon:d,colorIcon:m,colorIconHover:o}=t;return{[n]:{"&-actions":{marginInlineStart:c},[`${n}-close-icon`]:{marginInlineStart:c,padding:0,overflow:"hidden",fontSize:d,lineHeight:B(d),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${s}-close`]:{color:m,transition:`color ${r}`,"&:hover":{color:o}}},"&-close-text":{color:m,transition:`color ${r}`,"&:hover":{color:o}}}}},Zt=t=>({withDescriptionIconSize:t.fontSizeHeading3,defaultPadding:`${t.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${t.paddingMD}px ${t.paddingContentHorizontalLG}px`}),Qt=me("Alert",t=>[Kt(t),Yt(t),Jt(t)],Zt),en=t=>{const{icon:n,type:s,className:r,style:c,successIcon:d,infoIcon:m,warningIcon:o,errorIcon:i}=t,u={success:d??a.createElement(lt,null),info:m??a.createElement(it,null),error:i??a.createElement(ot,null),warning:o??a.createElement(Ne,null)};return a.createElement("span",{className:r,style:c},n??u[s])},tn=t=>{const{isClosable:n,prefixCls:s,closeIcon:r,handleClose:c,ariaProps:d,className:m,style:o}=t,i=r===!0||r===void 0?a.createElement(ct,null):r;return n?a.createElement("button",{type:"button",onClick:c,className:$(`${s}-close-icon`,m),tabIndex:0,style:o,...d},i):null},Le=a.forwardRef((t,n)=>{const{description:s,prefixCls:r,message:c,title:d,banner:m,className:o,rootClassName:i,style:u,onMouseEnter:p,onMouseLeave:g,onClick:l,afterClose:h,showIcon:f,closable:x,closeText:j,closeIcon:w,action:b,id:v,styles:S,classNames:y,...I}=t,N=d??c,[V,X]=a.useState(!1),D=a.useRef(null);a.useImperativeHandle(n,()=>({nativeElement:D.current}));const{getPrefixCls:P,direction:R,closable:z,closeIcon:G,className:L,style:O,classNames:M,styles:H,successIcon:Y,infoIcon:A,warningIcon:J,errorIcon:te}=he("alert"),k=P("alert",r),[pe,ie]=Qt(k),{onClose:xe,afterClose:Ge}=x&&typeof x=="object"?x:{},Ke=K=>{X(!0),(xe??t.onClose)?.(K)},fe=a.useMemo(()=>t.type!==void 0?t.type:m?"warning":"info",[t.type,m]),Me=a.useMemo(()=>typeof x=="object"&&x.closeIcon||j?!0:typeof x=="boolean"?x:w!==!1&&st(w)?!0:!!z,[j,w,x,z]),ye=m&&f===void 0?!0:f,Ye={...t,prefixCls:k,type:fe,showIcon:ye,closable:Me},[Z,Q]=ge([M,y],[H,S],{props:Ye}),Je=$(k,`${k}-${fe}`,{[`${k}-with-description`]:!!s,[`${k}-no-icon`]:!ye,[`${k}-banner`]:!!m,[`${k}-rtl`]:R==="rtl"},L,o,i,Z.root,ie,pe),Ze=ve(I,{aria:!0,data:!0}),Qe=a.useMemo(()=>typeof x=="object"&&x.closeIcon?x.closeIcon:j||(w!==void 0?w:typeof z=="object"&&z.closeIcon?z.closeIcon:G),[w,x,z,j,G]),et=a.useMemo(()=>{const K=x??z;return typeof K=="object"?ve(K,{data:!0,aria:!0}):{}},[x,z]);return a.createElement(at,{visible:!V,motionName:`${k}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:K=>({maxHeight:K.offsetHeight}),onLeaveEnd:Ge??h},({className:K,style:tt},nt)=>a.createElement("div",{id:v,ref:rt(D,nt),"data-show":!V,className:$(Je,K),style:{...Q.root,...O,...u,...tt},onMouseEnter:p,onMouseLeave:g,onClick:l,role:"alert",...Ze},ye?a.createElement(en,{className:$(`${k}-icon`,Z.icon),style:Q.icon,description:s,icon:t.icon,prefixCls:k,type:fe,successIcon:Y,infoIcon:A,warningIcon:J,errorIcon:te}):null,a.createElement("div",{className:$(`${k}-section`,Z.section),style:Q.section},N?a.createElement("div",{className:$(`${k}-title`,Z.title),style:Q.title},N):null,s?a.createElement("div",{className:$(`${k}-description`,Z.description),style:Q.description},s):null),b?a.createElement("div",{className:$(`${k}-actions`,Z.actions),style:Q.actions},b):null,a.createElement(tn,{className:Z.close,style:Q.close,isClosable:Me,prefixCls:k,closeIcon:Qe,handleClose:Ke,ariaProps:et})))});function nn(t,n,s){return n=ze(n),dt(t,ut()?Reflect.construct(n,s||[],ze(t).constructor):n.apply(t,s))}let sn=(function(t){function n(){var s;return gt(this,n),s=nn(this,n,arguments),s.state={error:void 0,info:{componentStack:""}},s}return mt(n,t),ht(n,[{key:"componentDidCatch",value:function(r,c){this.setState({error:r,info:c})}},{key:"render",value:function(){const{message:r,title:c,description:d,id:m,children:o}=this.props,{error:i,info:u}=this.state,p=c??r,g=u?.componentStack||null,l=typeof p>"u"?(i||"").toString():p,h=typeof d>"u"?g:d;return i?a.createElement(Le,{id:m,type:"error",title:l,description:a.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},h)}):o}}])})(a.Component);const re=Le;re.ErrorBoundary=sn;const an=t=>{const{componentCls:n,iconCls:s,antCls:r,zIndexPopup:c,colorText:d,colorWarning:m,marginXXS:o,marginXS:i,fontSize:u,fontWeightStrong:p,colorTextHeading:g}=t;return{[n]:{zIndex:c,[`&${r}-popover`]:{fontSize:u},[`${n}-message`]:{marginBottom:i,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${n}-message-icon ${s}`]:{color:m,fontSize:u,lineHeight:1,marginInlineEnd:i},[`${n}-title`]:{fontWeight:p,color:g,"&:only-child":{fontWeight:"normal"}},[`${n}-description`]:{marginTop:o,color:d}},[`${n}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:i}}}}},rn=t=>{const{zIndexPopupBase:n}=t;return{zIndexPopup:n+60}},Be=me("Popconfirm",t=>an(t),rn,{resetStyle:!1}),qe=t=>{const{prefixCls:n,okButtonProps:s,cancelButtonProps:r,title:c,description:d,cancelText:m,okText:o,okType:i="primary",icon:u=a.createElement(Ne,null),showCancel:p=!0,close:g,onConfirm:l,onCancel:h,onPopupClick:f,classNames:x,styles:j}=t,{getPrefixCls:w}=a.useContext(_e),[b]=pt("Popconfirm",xt.Popconfirm),v=Ae(c),S=Ae(d);return a.createElement("div",{className:`${n}-inner-content`,onClick:f},a.createElement("div",{className:`${n}-message`},u&&a.createElement("span",{className:`${n}-message-icon`},u),a.createElement("div",{className:`${n}-message-text`},v&&a.createElement("div",{className:$(`${n}-title`,x?.title),style:j?.title},v),S&&a.createElement("div",{className:$(`${n}-description`,x?.content),style:j?.content},S))),a.createElement("div",{className:`${n}-buttons`},p&&a.createElement(U,{onClick:h,size:"small",...r},m||b?.cancelText),a.createElement(ft,{buttonProps:{size:"small",...yt(i),...s},actionFn:l,close:g,prefixCls:w("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},o||b?.okText)))},on=t=>{const{prefixCls:n,placement:s,className:r,style:c,...d}=t,{getPrefixCls:m}=a.useContext(_e),o=m("popconfirm",n);return Be(o),a.createElement(vt,{placement:s,className:$(o,r),style:c,content:a.createElement(qe,{prefixCls:o,...d})})},ln=a.forwardRef((t,n)=>{const{prefixCls:s,placement:r="top",trigger:c,okType:d="primary",icon:m=a.createElement(Ne,null),children:o,overlayClassName:i,onOpenChange:u,overlayStyle:p,styles:g,arrow:l,classNames:h,...f}=t,{getPrefixCls:x,className:j,style:w,classNames:b,styles:v,arrow:S,trigger:y}=he("popconfirm"),[I,N]=ke(t.defaultOpen??!1,t.open),V=bt(l,S),X=c||y||"click",D=A=>{N(A),u?.(A)},P=()=>{D(!1)},R=A=>t.onConfirm?.call(void 0,A),z=A=>{D(!1),t.onCancel?.call(void 0,A)},G=A=>{const{disabled:J=!1}=t;J||D(A)},L=x("popconfirm",s),O={...t,placement:r,trigger:X,okType:d,overlayStyle:p,styles:g,classNames:h},[M,H]=ge([b,h],[v,g],{props:O}),Y=$(L,j,i,M.root);return Be(L),a.createElement(jt,{arrow:V,...St(f,["title"]),trigger:X,placement:r,onOpenChange:G,open:I,ref:n,classNames:{root:Y,container:M.container,arrow:M.arrow},styles:{root:{...w,...H.root,...p},container:H.container,arrow:H.arrow},content:a.createElement(qe,{okType:d,icon:m,...t,prefixCls:L,close:P,onConfirm:R,onCancel:z,classNames:M,styles:H}),"data-popover-inject":!0},o)}),oe=ln;oe._InternalPanelDoNotUseOrYouWillBeFired=on;var cn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};function Se(){return Se=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Se.apply(this,arguments)}const dn=(t,n)=>a.createElement(Ee,Se({},t,{ref:n,icon:cn})),un=a.forwardRef(dn),mn=t=>{const{value:n,formatter:s,precision:r,decimalSeparator:c,groupSeparator:d="",prefixCls:m}=t;let o;if(typeof s=="function")o=s(n);else{const i=String(n),u=i.match(/^(-?)(\d*)(\.(\d+))?$/);if(!u||i==="-")o=i;else{const p=u[1];let g=u[2]||"0",l=u[4]||"";g=g.replace(/\B(?=(\d{3})+(?!\d))/g,d),typeof r=="number"&&(l=l.padEnd(r,"0").slice(0,r>0?r:0)),l&&(l=`${c}${l}`),o=[a.createElement("span",{key:"int",className:`${m}-content-value-int`},p,g),l&&a.createElement("span",{key:"decimal",className:`${m}-content-value-decimal`},l)]}}return a.createElement("span",{className:`${m}-content-value`},o)},hn=t=>{const{componentCls:n,marginXXS:s,padding:r,colorTextDescription:c,titleFontSize:d,colorTextHeading:m,contentFontSize:o,fontFamily:i}=t;return{[n]:{...Ie(t),[`${n}-header`]:{paddingBottom:s,[`${n}-title`]:{color:c,fontSize:d}},[`${n}-skeleton`]:{paddingTop:r},[`${n}-content`]:{color:m,fontSize:o,fontFamily:i,[`${n}-content-value`]:{display:"inline-block",direction:"ltr"},[`${n}-content-prefix, ${n}-content-suffix`]:{display:"inline-block"},[`${n}-content-prefix`]:{marginInlineEnd:s},[`${n}-content-suffix`]:{marginInlineStart:s}}}}},gn=t=>{const{fontSizeHeading3:n,fontSize:s}=t;return{titleFontSize:s,contentFontSize:n}},pn=me("Statistic",t=>{const n=De(t,{});return hn(n)},gn),ee=a.forwardRef((t,n)=>{const{prefixCls:s,className:r,rootClassName:c,style:d,valueStyle:m,value:o=0,title:i,valueRender:u,prefix:p,suffix:g,loading:l=!1,formatter:h,precision:f,decimalSeparator:x=".",groupSeparator:j=",",onMouseEnter:w,onMouseLeave:b,styles:v,classNames:S,...y}=t,{getPrefixCls:I,direction:N,className:V,style:X,classNames:D,styles:P}=he("statistic"),R=I("statistic",s),[z,G]=pn(R),L={...t,decimalSeparator:x,groupSeparator:j,loading:l,value:o},[O,M]=ge([D,S],[P,v],{props:L}),H=a.createElement(mn,{decimalSeparator:x,groupSeparator:j,prefixCls:R,formatter:h,precision:f,value:o}),Y=$(R,{[`${R}-rtl`]:N==="rtl"},V,r,c,O.root,z,G),A=$(`${R}-header`,O.header),J=$(`${R}-title`,O.title),te=$(`${R}-content`,O.content),k=$(`${R}-content-prefix`,O.prefix),pe=$(`${R}-content-suffix`,O.suffix),ie=a.useRef(null);a.useImperativeHandle(n,()=>({nativeElement:ie.current}));const xe=ve(y,{aria:!0,data:!0});return a.createElement("div",{...xe,className:Y,style:{...M.root,...X,...d},ref:ie,onMouseEnter:w,onMouseLeave:b},i&&a.createElement("div",{className:A,style:M.header},a.createElement("div",{className:J,style:M.title},i)),a.createElement(wt,{paragraph:!1,loading:l,className:`${R}-skeleton`,active:!0},a.createElement("div",{className:te,style:{...m,...M.content}},p&&a.createElement("span",{className:k,style:M.prefix},p),u?u(H):H,g&&a.createElement("span",{className:pe,style:M.suffix},g))))}),xn=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function fn(t,n){let s=t;const r=/\[[^\]]*]/g,c=(n.match(r)||[]).map(i=>i.slice(1,-1)),d=n.replace(r,"[]"),m=xn.reduce((i,[u,p])=>{if(i.includes(u)){const g=Math.floor(s/p);return s-=g*p,i.replace(new RegExp(`${u}+`,"g"),l=>{const h=l.length;return g.toString().padStart(h,"0")})}return i},d);let o=0;return m.replace(r,()=>{const i=c[o];return o+=1,i})}function yn(t,n,s){const{format:r=""}=n,c=new Date(t).getTime(),d=Date.now(),m=Math.max(s?c-d:d-c,0);return fn(m,r)}const vn=1e3/60;function bn(t){return new Date(t).getTime()}const We=t=>{const{value:n,format:s="HH:mm:ss",onChange:r,onFinish:c,type:d,...m}=t,o=d==="countdown",[i,u]=a.useState(null),p=Ct(()=>{const h=Date.now(),f=bn(n);u({});const x=o?f-h:h-f;return r?.(x),o&&f<h?(c?.(),!1):!0});a.useEffect(()=>{let h;const f=()=>{p()||window.clearInterval(h)},x=()=>{h=window.setInterval(f,vn)},j=()=>{window.clearInterval(h)};return x(),()=>{j()}},[n,o]),a.useEffect(()=>{u({})},[]);const g=(h,f)=>i?yn(h,{...f,format:s},o):"-",l=h=>$t(h,{title:void 0});return a.createElement(ee,{...m,value:n,valueRender:l,formatter:g})},jn=t=>a.createElement(We,{...t,type:"countdown"}),Sn=a.memo(jn);ee.Timer=We;ee.Countdown=Sn;function we(){return we=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},we.apply(this,arguments)}const Ve=a.forwardRef(({prefixCls:t="rc-switch",className:n,checked:s,defaultChecked:r,disabled:c,loadingIcon:d,checkedChildren:m,unCheckedChildren:o,onClick:i,onChange:u,onKeyDown:p,styles:g,classNames:l,...h},f)=>{const[x,j]=ke(r??!1,s);function w(y,I){let N=x;return c||(N=y,j(N),u?.(N,I)),N}function b(y){y.which===Ue.LEFT?w(!1,y):y.which===Ue.RIGHT&&w(!0,y),p?.(y)}function v(y){const I=w(!x,y);i?.(I,y)}const S=$(t,n,{[`${t}-checked`]:x,[`${t}-disabled`]:c});return a.createElement("button",we({},h,{type:"button",role:"switch","aria-checked":x,disabled:c,className:S,ref:f,onKeyDown:b,onClick:v}),d,a.createElement("span",{className:`${t}-inner`},a.createElement("span",{className:$(`${t}-inner-checked`,l?.content),style:g?.content},m),a.createElement("span",{className:$(`${t}-inner-unchecked`,l?.content),style:g?.content},o)))});Ve.displayName="Switch";const wn=t=>{const{componentCls:n,trackHeightSM:s,trackPadding:r,trackMinWidthSM:c,innerMinMarginSM:d,innerMaxMarginSM:m,handleSizeSM:o,calc:i}=t,u=`${n}-inner`,p=B(i(o).add(i(r).mul(2)).equal()),g=B(i(m).mul(2).equal());return{[n]:{[`&${n}-small`]:{minWidth:c,height:s,lineHeight:B(s),[`${n}-inner`]:{paddingInlineStart:m,paddingInlineEnd:d,[`${u}-checked, ${u}-unchecked`]:{minHeight:s},[`${u}-checked`]:{marginInlineStart:`calc(-100% + ${p} - ${g})`,marginInlineEnd:`calc(100% - ${p} + ${g})`},[`${u}-unchecked`]:{marginTop:i(s).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${n}-handle`]:{width:o,height:o},[`${n}-loading-icon`]:{top:i(i(o).sub(t.switchLoadingIconSize)).div(2).equal(),fontSize:t.switchLoadingIconSize},[`&${n}-checked`]:{[`${n}-inner`]:{paddingInlineStart:d,paddingInlineEnd:m,[`${u}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${u}-unchecked`]:{marginInlineStart:`calc(100% - ${p} + ${g})`,marginInlineEnd:`calc(-100% + ${p} - ${g})`}},[`${n}-handle`]:{insetInlineStart:`calc(100% - ${B(i(o).add(r).equal())})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${u}`]:{[`${u}-unchecked`]:{marginInlineStart:i(t.marginXXS).div(2).equal(),marginInlineEnd:i(t.marginXXS).mul(-1).div(2).equal()}},[`&${n}-checked ${u}`]:{[`${u}-checked`]:{marginInlineStart:i(t.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:i(t.marginXXS).div(2).equal()}}}}}}},Cn=t=>{const{componentCls:n,handleSize:s,calc:r}=t;return{[n]:{[`${n}-loading-icon${t.iconCls}`]:{position:"relative",top:r(r(s).sub(t.fontSize)).div(2).equal(),color:t.switchLoadingIconColor,verticalAlign:"top"},[`&${n}-checked ${n}-loading-icon`]:{color:t.switchColor}}}},$n=t=>{const{componentCls:n,trackPadding:s,handleBg:r,handleShadow:c,handleSize:d,calc:m}=t,o=`${n}-handle`;return{[n]:{[o]:{position:"absolute",top:s,insetInlineStart:s,width:d,height:d,transition:`all ${t.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:r,borderRadius:m(d).div(2).equal(),boxShadow:c,transition:`all ${t.switchDuration} ease-in-out`,content:'""'}},[`&${n}-checked ${o}`]:{insetInlineStart:`calc(100% - ${B(m(d).add(s).equal())})`},[`&:not(${n}-disabled):active`]:{[`${o}::before`]:{insetInlineEnd:t.switchHandleActiveInset,insetInlineStart:0},[`&${n}-checked ${o}::before`]:{insetInlineEnd:0,insetInlineStart:t.switchHandleActiveInset}}}}},In=t=>{const{componentCls:n,trackHeight:s,trackPadding:r,innerMinMargin:c,innerMaxMargin:d,handleSize:m,calc:o}=t,i=`${n}-inner`,u=B(o(m).add(o(r).mul(2)).equal()),p=B(o(d).mul(2).equal());return{[n]:{[i]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:d,paddingInlineEnd:c,transition:`padding-inline-start ${t.switchDuration} ease-in-out, padding-inline-end ${t.switchDuration} ease-in-out`,[`${i}-checked, ${i}-unchecked`]:{display:"block",color:t.colorTextLightSolid,fontSize:t.fontSizeSM,transition:`margin-inline-start ${t.switchDuration} ease-in-out, margin-inline-end ${t.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:s},[`${i}-checked`]:{marginInlineStart:`calc(-100% + ${u} - ${p})`,marginInlineEnd:`calc(100% - ${u} + ${p})`},[`${i}-unchecked`]:{marginTop:o(s).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${n}-checked ${i}`]:{paddingInlineStart:c,paddingInlineEnd:d,[`${i}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${i}-unchecked`]:{marginInlineStart:`calc(100% - ${u} + ${p})`,marginInlineEnd:`calc(-100% + ${u} - ${p})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${i}`]:{[`${i}-unchecked`]:{marginInlineStart:o(r).mul(2).equal(),marginInlineEnd:o(r).mul(-1).mul(2).equal()}},[`&${n}-checked ${i}`]:{[`${i}-checked`]:{marginInlineStart:o(r).mul(-1).mul(2).equal(),marginInlineEnd:o(r).mul(2).equal()}}}}}},Nn=t=>{const{componentCls:n,trackHeight:s,trackMinWidth:r}=t;return{[n]:{...Ie(t),position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:r,height:s,lineHeight:B(s),verticalAlign:"middle",background:t.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${t.motionDurationMid}`,userSelect:"none",[`&:hover:not(${n}-disabled)`]:{background:t.colorTextTertiary},...It(t),[`&${n}-checked`]:{background:t.switchColor,[`&:hover:not(${n}-disabled)`]:{background:t.colorPrimaryHover}},[`&${n}-loading, &${n}-disabled`]:{cursor:"not-allowed",opacity:t.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${n}-rtl`]:{direction:"rtl"}}}},kn=t=>{const{fontSize:n,lineHeight:s,controlHeight:r,colorWhite:c}=t,d=n*s,m=r/2,o=2,i=d-o*2,u=m-o*2;return{trackHeight:d,trackHeightSM:m,trackMinWidth:i*2+o*4,trackMinWidthSM:u*2+o*2,trackPadding:o,handleBg:c,handleSize:i,handleSizeSM:u,handleShadow:`0 2px 4px 0 ${new Nt("#00230b").setA(.2).toRgbString()}`,innerMinMargin:i/2,innerMaxMargin:i+o+o*2,innerMinMarginSM:u/2,innerMaxMarginSM:u+o+o*2}},En=me("Switch",t=>{const n=De(t,{switchDuration:t.motionDurationMid,switchColor:t.colorPrimary,switchDisabledOpacity:t.opacityLoading,switchLoadingIconSize:t.calc(t.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${t.opacityLoading})`,switchHandleActiveInset:"-30%"});return[Nn(n),In(n),$n(n),Cn(n),wn(n)]},kn),Tn=a.forwardRef((t,n)=>{const{prefixCls:s,size:r,disabled:c,loading:d,className:m,rootClassName:o,style:i,checked:u,value:p,defaultChecked:g,defaultValue:l,onChange:h,styles:f,classNames:x,...j}=t,[w,b]=ke(g??l??!1,u??p),{getPrefixCls:v,direction:S,className:y,style:I,classNames:N,styles:V}=he("switch"),X=a.useContext(kt),D=(c??X)||d,P=v("switch",s),R=a.createElement("div",{className:`${P}-handle`},d&&a.createElement(Rt,{className:`${P}-loading-icon`})),[z,G]=En(P),L=Et(r),O={...t,size:L,disabled:D},[M,H]=ge([N,x],[V,f],{props:O}),Y=$(y,{[`${P}-small`]:L==="small",[`${P}-loading`]:d,[`${P}-rtl`]:S==="rtl"},m,o,M.root,z,G),A={...H.root,...I,...i},J=(...te)=>{b(te[0]),h?.(...te)};return a.createElement(Tt,{component:"Switch",disabled:D},a.createElement(Ve,{...j,classNames:M,styles:H,checked:w,onChange:J,prefixCls:P,className:Y,style:A,disabled:D,ref:n,loadingIcon:R}))}),Xe=Tn;Xe.__ANT_SWITCH=!0;const Rn=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Mn=Mt("ban",Rn);var zn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};function Ce(){return Ce=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Ce.apply(this,arguments)}const An=(t,n)=>a.createElement(Ee,Ce({},t,{ref:n,icon:zn})),Un=a.forwardRef(An);var Pn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 642.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 505 759.6 431.7 759.6 349c0-137-110.8-248-247.5-248S264.7 212 264.7 349c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 888.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 628.2 432.2 597 512.2 597c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 521c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 349c0-45.9 17.9-89.1 50.3-121.6S466.3 177 512.2 177s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 349c0 45.9-17.9 89.1-50.3 121.6C601.1 503.1 558 521 512.2 521zM880 759h-84v-84c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v84h-84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h84v84c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-84h84c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-add",theme:"outlined"};function $e(){return $e=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},$e.apply(this,arguments)}const _n=(t,n)=>a.createElement(Ee,$e({},t,{ref:n,icon:Pn})),Dn=a.forwardRef(_n),{Title:q,Text:C,Paragraph:E}=Vt;function as(){const{appId:t}=zt(),n=At(),[s,r]=a.useState(null),[c,d]=a.useState(!1);a.useEffect(()=>{t&&m()},[t]);const m=async()=>{d(!0);try{const{data:i}=await T.get(`/apps/details?id=${t}`);r(i.data)}catch{se.useApp().message.error("Could not load app details"),n("/dashboard")}finally{d(!1)}};if(c)return e.jsx(Ut,{});if(!s)return e.jsx(Dt,{});const o=[{key:"stats",label:"Analytics",children:e.jsx(Wn,{app:s})},{key:"security",label:"Security",children:e.jsx(On,{app:s})},{key:"members",label:"Members",children:e.jsx(Hn,{app:s})},{key:"help",label:"Integration Guide",children:e.jsx(Ln,{app:s})},{key:"settings",label:"Settings",children:e.jsx(Fn,{app:s,onUpdate:m,onDelete:()=>n("/dashboard")})}];return e.jsxs(ae,{className:"max-w-5xl w-full shadow-xl",title:"Manage Application",extra:e.jsx(U,{icon:e.jsx(Xt,{}),onClick:()=>n(-1),children:"Back"}),children:[e.jsxs(W,{size:10,align:"center",className:"mb-3",children:[e.jsx(Pt,{size:48,url:{url:s.logoUrl,text:s.name}}),e.jsx(q,{level:3,style:{marginBottom:0},children:s.name}),e.jsx(Fe,{color:"blue",children:s.role})]}),s.suspendUntil&&je(s.suspendUntil).isAfter(je())&&e.jsx(re,{type:"error",title:"This app is suspended until "+Te(s.suspendUntil)}),e.jsx(He,{defaultActiveKey:"stats",items:o})]})}function On({app:t}){const{message:n}=se.useApp(),[s,r]=a.useState([]),[c,d]=a.useState(!1),[m,o]=a.useState(!1),[i,u]=a.useState(""),[p,g]=a.useState(""),[l,h]=a.useState(t.deviceCodeEnabled??!0),[f,x]=a.useState(!1);a.useEffect(()=>{j()},[t.id]),a.useEffect(()=>{h(t.deviceCodeEnabled??!0)},[t.deviceCodeEnabled]);const j=async()=>{d(!0);try{const{data:y}=await T.get(`/apps/uris?id=${t.id}`);r(y.data||[])}catch{}finally{d(!1)}},w=async()=>{const y=p.trim();if(!y){n.error("URI is required");return}try{await T.post("/apps/uris/add",{appId:t.id,name:i.trim(),uri:y}),n.success("Trusted URI added"),o(!1),u(""),g(""),j()}catch(I){const N=I.response?.data?.message||"Failed to add trusted URI";n.error(N)}},b=async y=>{try{await T.post("/apps/uris/delete",{appId:t.id,uriId:y}),n.success("Trusted URI removed"),j()}catch(I){const N=I.response?.data?.message||"Failed to remove trusted URI";n.error(N)}},v=async y=>{x(!0);try{await T.post("/apps/device-code/toggle",{appId:t.id,enabled:y}),h(y),n.success(`Device code flow ${y?"enabled":"disabled"}`)}catch(I){const N=I.response?.data?.message||"Failed to update device code settings";n.error(N),h(!y)}finally{x(!1)}},S=[{title:"Name",dataIndex:"name",key:"name",render:y=>y||e.jsx(C,{type:"secondary",children:"Unnamed"})},{title:"URI",dataIndex:"uri",key:"uri",render:y=>e.jsx(C,{copyable:!0,children:y})},{title:"Added At",dataIndex:"createdAt",key:"createdAt",render:y=>Te(y)},{title:"Action",key:"action",render:(y,I)=>e.jsx(oe,{title:"Delete this URI?",onConfirm:()=>b(I.id),okText:"Yes",cancelText:"No",children:e.jsx(U,{type:"text",danger:!0,icon:e.jsx(ue,{})})})}];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx(C,{children:"Manage redirect URIs allowed by Authorization Code flow."})}),t.role!=="external"&&e.jsx(U,{type:"primary",icon:e.jsx(Wt,{}),onClick:()=>o(!0),children:"Add URI"})]}),e.jsx(Re,{dataSource:s,columns:S,rowKey:"id",loading:c,pagination:!1}),t.role!=="external"&&e.jsx(ae,{size:"small",children:e.jsx(W,{direction:"vertical",style:{width:"100%"},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(C,{strong:!0,children:"Device Code Flow"}),e.jsx("br",{}),e.jsx(C,{type:"secondary",style:{fontSize:"12px"},children:"Allow this application to use Device Code flow for authentication."})]}),e.jsx(Xe,{checked:l,onChange:v,loading:f,disabled:t.role==="external"})]})})}),e.jsxs(Oe,{title:"Add Trusted URI",open:m,onCancel:()=>{o(!1),u(""),g("")},onOk:w,okText:"Add",children:[e.jsxs(_,{layout:"vertical",children:[e.jsx(_.Item,{label:"Name",children:e.jsx(F,{placeholder:"e.g. Local dev callback",value:i,onChange:y=>u(y.target.value)})}),e.jsx(_.Item,{label:"URI",required:!0,children:e.jsx(F,{placeholder:"https://example.com/callback",value:p,onChange:y=>g(y.target.value)})})]}),e.jsx(E,{children:"Enter full URI including scheme. Wildcards(*) are not allowed."})]})]})}function Hn({app:t}){const[n,s]=a.useState([]),[r,c]=a.useState(!1),[d,m]=a.useState(!1),[o,i]=a.useState(""),[u,p]=a.useState("admin"),{message:g}=se.useApp(),{profile:l}=_t();a.useEffect(()=>{h()},[t.id]);const h=async()=>{c(!0);try{const{data:v}=await T.get(`/apps/members?id=${t.id}`);s(v.data||[])}catch{}finally{c(!1)}},f=async()=>{try{await T.post("/apps/members/add",{appId:t.id,username:o,role:u}),g.success("Member added"),m(!1),i(""),h()}catch(v){const S=v.response?.data?.message||"Failed to add member";g.error(S)}},x=async v=>{try{await T.post("/apps/members/remove",{appId:t.id,username:v}),g.success("Member removed"),h()}catch{g.error("Failed to remove member")}},j=async(v,S)=>{try{await T.post("/apps/members/role",{appId:t.id,username:v,role:S}),g.success("Role updated"),h()}catch{g.error("Failed to update role")}},w=[{label:"Admin",value:"admin"},{label:"Root",value:"root"}],b=[{title:"Username",dataIndex:"username",key:"username"},{title:"Role",dataIndex:"role",key:"role",render:v=>e.jsx(Fe,{color:v==="root"?"gold":"blue",children:v})},{title:"Action",key:"action",render:(v,S)=>S.username===l?.username?e.jsx(W,{children:e.jsx(oe,{title:"Remove yourself? You'll lose access to this app!",onConfirm:()=>x(S.username),okText:"Yes",cancelText:"No",children:e.jsx(U,{danger:!0,size:"small",icon:e.jsx(ue,{}),children:"Leave"})})}):t.role!=="root"?e.jsx(Mn,{size:18}):e.jsxs(W,{children:[e.jsx(le,{value:S.role,onChange:y=>j(S.username,y),options:w,size:"small",className:"w-20"}),e.jsx(oe,{title:`Remove ${S.username} from this app?`,onConfirm:()=>x(S.username),okText:"Yes",cancelText:"No",children:e.jsx(U,{danger:!0,size:"small",icon:e.jsx(ue,{})})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(C,{children:"Manage team members and their access levels."}),t.role==="root"&&e.jsx(U,{type:"primary",icon:e.jsx(Dn,{}),onClick:()=>m(!0),children:"Add Member"})]}),e.jsx(Re,{dataSource:n,columns:b,rowKey:"username",loading:r,pagination:!1}),e.jsx(Oe,{title:"Add New Member",open:d,onCancel:()=>m(!1),onOk:f,okText:"Add",children:e.jsxs(_,{layout:"vertical",children:[e.jsx(_.Item,{label:"Username",required:!0,children:e.jsx(F,{value:o,onChange:v=>i(v.target.value),placeholder:"Username"})}),e.jsx(_.Item,{label:"Role",required:!0,children:e.jsxs(le,{value:u,onChange:p,children:[e.jsx(le.Option,{value:"admin",children:"Admin"}),e.jsx(le.Option,{value:"root",children:"Root"})]})})]})})]})}function Fn({app:t,onUpdate:n,onDelete:s}){const{message:r}=se.useApp(),[c]=_.useForm(),[d,m]=a.useState(!1),[o,i]=a.useState(null);a.useEffect(()=>{c.setFieldsValue({name:t.name,description:t.description,logoUrl:t.logoUrl}),i(null)},[t]);const u=async l=>{m(!0);try{if(o){const h=new FormData;h.append("appId",t.id),h.append("name",l.name),h.append("description",l.description||""),h.append("logoUrl",l.logoUrl||""),h.append("file",o),await T.post("/apps/update",h,{headers:{"Content-Type":"multipart/form-data"}})}else await T.post("/apps/update",{appId:t.id,name:l.name,description:l.description,logoUrl:l.logoUrl});r.success("App updated"),n(),i(null)}catch(h){const f=h;console.error("Failed to update app",f.response),r.error(f.response?.data?.error||"Failed to update app")}finally{m(!1)}},p=async()=>{try{await T.post("/apps/delete",{appId:t.id}),r.success("App deleted"),s()}catch(l){const h=l.response?.data?.message||"Failed to delete app";r.error(h)}},g=t.role==="root";return e.jsxs("div",{className:"max-w-3xl",children:[e.jsx(q,{level:4,children:"General Settings"}),e.jsxs(_,{form:c,layout:"vertical",onFinish:u,children:[e.jsx(_.Item,{label:"App Name",name:"name",rules:[{required:!0,message:"Please input app name!"}],children:e.jsx(F,{})}),e.jsx(_.Item,{label:"Description",name:"description",children:e.jsx(F.TextArea,{rows:4})}),e.jsx(_.Item,{label:"Logo URL",children:e.jsxs(W.Compact,{style:{width:"100%"},children:[e.jsx(_.Item,{name:"logoUrl",noStyle:!0,children:e.jsx(F,{placeholder:"https://example.com/logo.png"})}),e.jsx(Ot,{rotationSlider:!0,children:e.jsx(Lt,{showUploadList:!1,customRequest:({file:l,onSuccess:h})=>{const f=l;i(f);const x=URL.createObjectURL(f);c.setFieldValue("logoUrl",x),r.success("Logo selected. Click Save to apply."),h?.("ok")},children:e.jsx(U,{icon:e.jsx(Bt,{}),children:"Select"})})})]})}),e.jsx(_.Item,{children:e.jsx(U,{type:"primary",htmlType:"submit",icon:e.jsx(Un,{}),loading:d,children:"Save Changes"})})]}),g&&e.jsxs(e.Fragment,{children:[e.jsx(Gt,{}),e.jsxs("div",{className:"border border-red-200 dark:border-red-900 p-4 rounded-lg bg-red-50 dark:bg-red-900/20",children:[e.jsx(q,{level:5,type:"danger",children:"Danger Zone"}),e.jsx(E,{children:"Deleting this application will remove all associated data, including API keys and member associations. This action cannot be undone."}),e.jsx(oe,{title:"Are you sure you want to delete this app?",description:"This action cannot be undone.",onConfirm:p,okText:"Yes, delete it",okType:"danger",cancelText:"Cancel",children:e.jsx(U,{type:"primary",danger:!0,icon:e.jsx(ue,{}),children:"Delete Application"})})]})]})]})}function Ln({app:t}){const n=[{key:"authcode",label:"Authorization Code Flow",children:e.jsx(Bn,{app:t})},{key:"device",label:"Device Code Flow",children:e.jsx(qn,{app:t})}];return e.jsx("div",{className:"max-w-4xl space-y-8",children:e.jsxs("div",{children:[e.jsx(q,{level:3,children:"Integration Guide"}),e.jsx(E,{children:"Select the authentication flow that best suits your application."}),e.jsx(He,{items:n})]})})}function Bn({app:t}){let n=be.API_URL;n.endsWith("/")&&(n=n.slice(0,-1));const{message:s}=se.useApp(),[r,c]=a.useState(""),[d,m]=a.useState(ce(16)),[o,i]=a.useState(ce(43)),[u,p]=a.useState(""),[g,l]=a.useState(""),[h,f]=a.useState(null);a.useEffect(()=>{qt(o).then(p)},[o]);const x=()=>{const b=ce(43);i(b),m(ce(16))},j=()=>{const b=new URLSearchParams({response_type:"code",client_id:t.id,redirect_uri:r,state:d,code_challenge:u,code_challenge_method:"S256"}),v=`${be.API_URL}/oauth2/authorize?${b.toString()}`;window.open(v,"_blank"),s.info("Opens provider authorization page. After approval, copy the 'code' from the URL.")},w=async()=>{if(!g){s.error("Please enter the authorization code");return}try{const{data:b}=await T.post("/oauth2/token",{grant_type:"authorization_code",client_id:t.id,code:g,code_verifier:o});f(b),s.success("Token exchanged successfully!")}catch(b){const v=b.response?.data?.error||"Failed to exchange token";s.error(v),f({error:v})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(re,{title:"Recommended for Web / Mobile Apps",description:"Authorization Code Flow with PKCE is the most secure method for authenticating users in public clients. Use this as long as your app can securely handle redirects.",type:"info",showIcon:!0}),e.jsxs(W,{direction:"vertical",className:"w-full bg-gray-50 dark:bg-gray-900/20 p-4 rounded border border-gray-200 dark:border-gray-700 mt-4",children:[e.jsx(q,{level:4,children:"Test Authorization Code Flow"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{strong:!0,children:"Client ID"}),e.jsx(F,{value:t.id,disabled:!0})]}),e.jsxs("div",{children:[e.jsx(C,{strong:!0,children:"Redirect URI"}),e.jsx(F,{value:r,onChange:b=>c(b.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{strong:!0,children:"State (Random)"}),e.jsx(F,{value:d,disabled:!0})]}),e.jsxs("div",{children:[e.jsx(C,{strong:!0,children:"Code Verifier (PKCE)"}),e.jsxs(W.Compact,{style:{width:"100%"},children:[e.jsx(F,{value:o,disabled:!0}),e.jsx(U,{icon:e.jsx(un,{}),onClick:x})]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsx(C,{strong:!0,children:"Code Challenge (S256(Verifier))"}),e.jsx(F,{value:u,disabled:!0})]})]}),e.jsx(U,{type:"primary",onClick:j,disabled:!u,children:"Simulate authorization request"}),e.jsxs(E,{className:"mb-0",children:["After approval, copy the ",e.jsx("code",{children:"code"})," query value from your redirect URI."]}),e.jsxs(W.Compact,{style:{width:"100%"},children:[e.jsx(F,{placeholder:"Paste authorization code here...",value:g,onChange:b=>l(b.target.value)}),e.jsx(U,{type:"primary",onClick:w,disabled:!g,children:"Exchange token"})]}),h&&e.jsxs("div",{className:"mt-2 bg-green-50 dark:bg-green-900/20 p-4 rounded border border-green-200",children:[e.jsx(C,{strong:!0,className:"text-green-600",children:"Token Response:"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 p-3 rounded text-sm text-gray-600 dark:text-gray-300 font-mono overflow-x-auto",children:JSON.stringify(h,null,2)})]})]}),e.jsxs("div",{children:[e.jsx(q,{level:4,children:"1. Initiate Authorization"}),e.jsx(E,{children:"Send the user to the authorization endpoint."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"GET"})," ",n,"/oauth2/authorize",e.jsx("br",{}),"?client_id=",t.id,e.jsx("br",{}),"&response_type=code",e.jsx("br",{}),"&redirect_uri=",encodeURIComponent(r),e.jsx("br",{}),"&state=",d,e.jsx("br",{}),"&code_challenge=",u,e.jsx("br",{}),"&code_challenge_method=S256"]})]}),e.jsx(re,{title:"The redirected_uri must match one of the app's registered trusted URIs. Add trusted URIs in the Security tab.",type:"warning",showIcon:!0}),e.jsxs("div",{className:"mt-6",children:[e.jsx(q,{level:4,children:"2. Exchange Code for Token"}),e.jsx(E,{children:"Exchange the received code for tokens."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"POST"})," ",n,"/oauth2/token",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"Content-Type:"})," application/json",e.jsx("br",{}),e.jsx("br",{}),`{
  "grant_type": "authorization_code",
  "client_id": "${t.id}",
  "code": "${g||"AUTHORIZATION_CODE"}",
  "code_verifier": "${o}"
}`]})]}),e.jsx(E,{className:"text-sm text-gray-500",children:"Response (Success):"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono",children:`{
  "access_token": "...",
  "token_type": "Bearer",
  "expires_in": 3600
}`})]})}function qn({app:t}){const{message:n}=se.useApp();let s=be.API_URL;s.endsWith("/")&&(s=s.slice(0,-1));const r=window.location.origin,[c,d]=a.useState(null),[m,o]=a.useState(""),[i,u]=a.useState(null),p=async()=>{d(null),u(null),o("Initiating...");try{const{data:g}=await T.post("/oauth2/devicecode",{client_id:t.id});d(g),o("Waiting for user authorization..."),n.success("Session initiated")}catch(g){const h=g.response?.data?.error||"Failed";o("Failed: "+h)}};return a.useEffect(()=>{if(!c||i)return;let g;const l=(c.interval||5)*1e3,h=async()=>{try{const{data:f}=await T.post("/oauth2/token",{client_id:t.id,device_code:c.device_code,grant_type:"urn:ietf:params:oauth:grant-type:device_code"});u(f),o("Success! Token received."),n.success("Token received!"),d(null)}catch(f){const x=f.response?.data?.error;x==="authorization_pending"?g=setTimeout(h,l):x==="slow_down"?(o("Slowing down..."),g=setTimeout(h,l+5e3)):(o("Failed or Expired: "+(x||"Unknown")),d(null))}};return g=setTimeout(h,l),()=>clearTimeout(g)},[c,i,t.id]),e.jsxs("div",{className:"max-w-3xl space-y-8",children:[e.jsxs("div",{children:[e.jsx(re,{title:"Suitable for CLI / Limited Input Devices",description:"Device Flow allows users to sign in on a secondary device using a short code or link. Only use this if your app cannot securely handle redirects or has limited input capabilities. Turned off by default for security reasons, enable in security tab if needed.",type:"info",showIcon:!0}),e.jsxs(W,{orientation:"vertical",className:"w-full bg-gray-50 dark:bg-gray-900/20 p-4 rounded border border-gray-200 dark:border-gray-700 mt-4",children:[e.jsx(q,{level:4,children:"Test Device Code Flow"}),e.jsx(U,{onClick:p,type:"primary",children:"Create test session"}),m&&e.jsxs("div",{className:"mt-4",children:[e.jsx(C,{strong:!0,children:"Status: "})," ",e.jsx(C,{children:m})]}),c&&e.jsxs("div",{className:"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-100 dark:border-blue-900",children:[e.jsxs(E,{className:"mb-1",children:["User Code:"," ",e.jsx(C,{copyable:!0,strong:!0,code:!0,children:c.user_code})]}),e.jsxs(E,{className:"mb-0",children:["Input the above code at:"," ",e.jsx("a",{href:c.verification_uri,target:"_blank",rel:"noopener noreferrer",children:c.verification_uri})]}),e.jsxs(E,{className:"mb-0",children:["Or visit:"," ",e.jsx("a",{href:c.verification_uri_complete,target:"_blank",rel:"noopener noreferrer",children:c.verification_uri_complete})]})]}),i&&e.jsxs("div",{className:"mt-2 bg-green-50 dark:bg-green-900/20 p-4 rounded border border-green-200",children:[e.jsx(C,{strong:!0,className:"text-green-600",children:"Access Token:"}),e.jsx(E,{className:"break-all font-mono text-xs",children:i.access_token}),i.refresh_token&&e.jsxs(e.Fragment,{children:[e.jsx(C,{strong:!0,className:"text-green-600",children:"Refresh Token:"}),e.jsx(E,{className:"break-all font-mono text-xs",children:i.refresh_token})]})]})]})]}),e.jsxs("div",{children:[e.jsx(q,{level:4,children:"1. Initiate Device Code Flow"}),e.jsx(E,{children:"Make a POST request to initiate the flow."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"POST"})," ",s,"/oauth2/devicecode",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"Content-Type:"})," application/json",e.jsx("br",{}),e.jsx("br",{}),`{ "client_id": "${t.id}" }`]}),e.jsx(E,{className:"mt-2 text-sm text-gray-500",children:"Response:"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 p-3 rounded text-sm text-gray-600 dark:text-gray-300 font-mono",children:`{
  "device_code": "...",
  "user_code": "WDJBMJHT",
  "verification_uri": "${r}/auth",
  "verification_uri_complete": "${r}/auth?user_code=WDJBMJHT",
  "expires_in": 900,
  "interval": 5
}`})]}),e.jsxs("div",{children:[e.jsx(q,{level:4,children:"2. Poll for Token"}),e.jsx(E,{children:"Poll the token endpoint using the `device_code` until the user authorizes."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"POST"})," ",s,"/oauth2/token",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"Content-Type:"})," application/json",e.jsx("br",{}),e.jsx("br",{}),`{
  "client_id": "${t.id}",
  "device_code": "...",
  "grant_type": "urn:ietf:params:oauth:grant-type:device_code"
}`]}),e.jsx(E,{className:"mt-2 text-sm text-gray-500",children:"Response (Pending):"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono mb-2",children:'{ "error": "authorization_pending" }'}),e.jsx(E,{className:"text-sm text-gray-500",children:"Response (Success):"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono",children:`{
  "access_token": "...",
  "token_type": "Bearer",
  "expires_in": 3600
}`})]})]})}function Wn({app:t}){const[n,s]=a.useState(null),[r,c]=a.useState([]),[d,m]=a.useState(!1),[o,i]=a.useState(null);a.useEffect(()=>{u()},[t.id]),a.useEffect(()=>{p(o)},[o,t.id]);const u=async()=>{m(!0);try{const{data:l}=await T.get(`/apps/stats?id=${t.id}`);s(l.data)}catch{}finally{m(!1)}},p=async l=>{let h=`/apps/history?id=${t.id}`;l&&(h+=`&date=${Ht(l)}&offset=${l.utcOffset()}`);try{const{data:f}=await T.get(h);c(f.data||[])}catch{}},g=a.useMemo(()=>n?.daily?n.daily:[],[n]);return d&&!n?e.jsx("div",{className:"p-4",children:"Loading stats..."}):n?e.jsxs("div",{children:[e.jsx(ae,{title:"Summary",className:"bg-white/90",style:{margin:"10px 0"},children:e.jsxs(Pe,{gutter:16,className:"text-center",children:[e.jsx(ne,{xs:12,sm:6,children:e.jsx(ee,{title:"Total Users",value:n.totalUsers})}),e.jsx(ne,{xs:12,sm:6,children:e.jsx(ee,{title:"Total Logins",value:n.totalLogins})}),e.jsx(ne,{xs:12,sm:6,children:e.jsx(ee,{title:"Active (24h)",value:n.activeUsers24h})}),e.jsx(ne,{xs:12,sm:6,children:e.jsx(ee,{title:"New (24h)",value:n.newUsers24h})})]})}),e.jsxs(Pe,{gutter:16,children:[e.jsx(ne,{xs:24,xl:12,children:e.jsx(ae,{title:"Traffic",style:{margin:"10px 0"},extra:e.jsx(C,{type:"secondary",children:"Days split by UTC"}),children:e.jsxs("div",{children:[e.jsx("div",{className:"flex items-end justify-between h-56 gap-2 px-2",children:g.map(l=>{const h=Math.max(...g.map(x=>Math.max(x.logins,x.activeUsers,x.newUsers))),f=h>0?160/h:0;return e.jsxs("div",{className:"flex flex-col items-center gap-2 group w-full overflow-hidden",children:[e.jsxs("div",{className:"flex gap-1 items-end h-[160px] w-full justify-center relative",children:[e.jsx("div",{className:"bg-indigo-400 dark:bg-indigo-600 w-3 rounded-t transition-all hover:bg-indigo-300",style:{height:`${Math.max(l.logins*f,4)}px`},title:`Logins: ${l.logins}`}),e.jsx("div",{className:"bg-emerald-400 dark:bg-emerald-600 w-3 rounded-t transition-all hover:bg-emerald-300",style:{height:`${Math.max(l.activeUsers*f,4)}px`},title:`Active Users: ${l.activeUsers}`}),e.jsx("div",{className:"bg-sky-400 dark:bg-sky-600 w-3 rounded-t transition-all hover:bg-sky-300",style:{height:`${Math.max(l.newUsers*f,4)}px`},title:`New Users: ${l.newUsers}`})]}),e.jsx("div",{className:"text-xs text-gray-500 whitespace-nowrap transform -rotate-45 origin-left mt-6 pl-4",children:je.utc(l.date).format("MM-DD")})]},l.date)})}),e.jsxs("div",{className:"flex justify-center flex-wrap gap-x-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-indigo-400 rounded"}),e.jsx(C,{type:"secondary",className:"text-xs",children:"Logins"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-emerald-400 rounded"}),e.jsx(C,{type:"secondary",className:"text-xs",children:"Active Users"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-sky-400 rounded"}),e.jsx(C,{type:"secondary",className:"text-xs",children:"New Users"})]})]})]})})}),e.jsx(ne,{xs:24,xl:12,children:e.jsxs(ae,{title:"Login History",style:{margin:"10px 0"},extra:e.jsx(Ft,{value:o,onChange:l=>i(l?l.utc():null),allowClear:!0}),children:[o&&e.jsxs(C,{children:[r.length," activities found"]}),e.jsx(Re,{dataSource:r,size:"small",pagination:{pageSize:10},locale:{emptyText:"No activity on selected date"},columns:[{title:"User",dataIndex:"user",key:"user",render:l=>l?e.jsx("span",{className:"flex items-center gap-2",children:l}):e.jsx(C,{type:"secondary",children:"Unknown"})},{title:"Time",dataIndex:"time",key:"time",render:l=>Te(l)}],rowKey:l=>l.time+(l.user||"unknown")})]})})]})]}):e.jsx("div",{className:"p-4",children:"No stats available."})}export{as as default};
