import{h as xe,N as Te,i as Y,r as a,k as fe,H as rt,l as ye,n as k,p as we,O as ot,Q as it,R as Ee,o as lt,T as ct,q as dt,J as ut,U as Pe,V as mt,W as ht,X as gt,Y as pt,Z as xt,y as Le,$ as ft,a0 as yt,a1 as _e,B as U,a2 as vt,a3 as jt,a4 as bt,a5 as Re,a6 as St,a7 as wt,F as Ct,I as Ue,m as He,a8 as $t,a9 as It,aa as Nt,ab as ze,ac as kt,ad as Tt,ae as Et,af as Rt,ag as Ut,ah as Mt,e as At,ai as Pt,a as _t,d as M,A as ae,j as e,f as zt,S as G,g as Dt,c as Ot,K as re}from"./index-q3coxKpc.js";import{F as Ft,I as Lt}from"./FailedView-C7wa0tgM.js";import{d as Ce,f as oe,t as Ht,F as pe,D as Bt,M as ge,S as ue,U as qt,R as Wt,a as le}from"./date-k-oYsZNN.js";import{g as me,s as Vt}from"./crypto-B9Mf35RN.js";import{C as ie,T as Be,R as De}from"./index-C6EakQ48.js";import{T as Gt,a as Oe}from"./index-BnR03HeS.js";import{T as qe}from"./index-Diw1ml-f.js";import{R as Xt}from"./ArrowLeftOutlined-DBF4nafy.js";import{R as Fe,C as ne,I as F,F as H}from"./index-BGxdU0Dl.js";import{D as Kt}from"./index-ClopC6KT.js";import"./TextArea-DBS6MHTP.js";import"./index-C_ZdSUz6.js";const he=(t,n,s,r,c)=>({background:t,border:`${Y(r.lineWidth)} ${r.lineType} ${n}`,[`${c}-icon`]:{color:s}}),Yt=t=>{const{componentCls:n,motionDurationSlow:s,marginXS:r,marginSM:c,fontSize:d,fontSizeLG:m,lineHeight:o,borderRadiusLG:i,motionEaseInOutCirc:u,withDescriptionIconSize:x,colorText:h,colorTextHeading:l,withDescriptionPadding:g,defaultPadding:y}=t;return{[n]:{...Te(t),position:"relative",display:"flex",alignItems:"center",padding:y,wordWrap:"break-word",borderRadius:i,[`&${n}-rtl`]:{direction:"rtl"},[`${n}-section`]:{flex:1,minWidth:0},[`${n}-icon`]:{marginInlineEnd:r,lineHeight:0},"&-description":{display:"none",fontSize:d,lineHeight:o},"&-title":{color:l},[`&${n}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${s} ${u}, opacity ${s} ${u},
        padding-top ${s} ${u}, padding-bottom ${s} ${u},
        margin-bottom ${s} ${u}`},[`&${n}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}},[`${n}-with-description`]:{alignItems:"flex-start",padding:g,[`${n}-icon`]:{marginInlineEnd:c,fontSize:x,lineHeight:0},[`${n}-title`]:{display:"block",marginBottom:r,color:l,fontSize:m},[`${n}-description`]:{display:"block",color:h}},[`${n}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},Jt=t=>{const{componentCls:n,colorSuccess:s,colorSuccessBorder:r,colorSuccessBg:c,colorWarning:d,colorWarningBorder:m,colorWarningBg:o,colorError:i,colorErrorBorder:u,colorErrorBg:x,colorInfo:h,colorInfoBorder:l,colorInfoBg:g}=t;return{[n]:{"&-success":he(c,r,s,t,n),"&-info":he(g,l,h,t,n),"&-warning":he(o,m,d,t,n),"&-error":{...he(x,u,i,t,n),[`${n}-description > pre`]:{margin:0,padding:0}}}}},Zt=t=>{const{componentCls:n,iconCls:s,motionDurationMid:r,marginXS:c,fontSizeIcon:d,colorIcon:m,colorIconHover:o}=t;return{[n]:{"&-actions":{marginInlineStart:c},[`${n}-close-icon`]:{marginInlineStart:c,padding:0,overflow:"hidden",fontSize:d,lineHeight:Y(d),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${s}-close`]:{color:m,transition:`color ${r}`,"&:hover":{color:o}}},"&-close-text":{color:m,transition:`color ${r}`,"&:hover":{color:o}}}}},Qt=t=>({withDescriptionIconSize:t.fontSizeHeading3,defaultPadding:`${t.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${t.paddingMD}px ${t.paddingContentHorizontalLG}px`}),en=xe("Alert",t=>[Yt(t),Jt(t),Zt(t)],Qt),tn=t=>{const{icon:n,type:s,className:r,style:c,successIcon:d,infoIcon:m,warningIcon:o,errorIcon:i}=t,u={success:d??a.createElement(dt,null),info:m??a.createElement(ct,null),error:i??a.createElement(lt,null),warning:o??a.createElement(Ee,null)};return a.createElement("span",{className:r,style:c},n??u[s])},nn=t=>{const{isClosable:n,prefixCls:s,closeIcon:r,handleClose:c,ariaProps:d,className:m,style:o}=t,i=r===!0||r===void 0?a.createElement(ut,null):r;return n?a.createElement("button",{type:"button",onClick:c,className:k(`${s}-close-icon`,m),tabIndex:0,style:o,...d},i):null},We=a.forwardRef((t,n)=>{const{description:s,prefixCls:r,message:c,title:d,banner:m,className:o,rootClassName:i,style:u,onMouseEnter:x,onMouseLeave:h,onClick:l,afterClose:g,showIcon:y,closable:p,closeText:$,closeIcon:S,action:T,id:v,styles:w,classNames:C,...z}=t,D=d??c,[V,j]=a.useState(!1),I=a.useRef(null);a.useImperativeHandle(n,()=>({nativeElement:I.current}));const{getPrefixCls:A,direction:E,closable:O,closeIcon:K,className:B,style:q,classNames:P,styles:W,successIcon:J,infoIcon:L,warningIcon:f,errorIcon:_}=fe("alert"),N=A("alert",r),[ve,de]=en(N),{onClose:je,afterClose:Ye}=p&&typeof p=="object"?p:{},Je=Z=>{j(!0),(je??t.onClose)?.(Z)},be=a.useMemo(()=>t.type!==void 0?t.type:m?"warning":"info",[t.type,m]),Ae=a.useMemo(()=>typeof p=="object"&&p.closeIcon||$?!0:typeof p=="boolean"?p:S!==!1&&rt(S)?!0:!!O,[$,S,p,O]),Se=m&&y===void 0?!0:y,Ze={...t,prefixCls:N,type:be,showIcon:Se,closable:Ae},[Q,ee]=ye([P,C],[W,w],{props:Ze}),Qe=k(N,`${N}-${be}`,{[`${N}-with-description`]:!!s,[`${N}-no-icon`]:!Se,[`${N}-banner`]:!!m,[`${N}-rtl`]:E==="rtl"},B,o,i,Q.root,de,ve),et=we(z,{aria:!0,data:!0}),tt=a.useMemo(()=>typeof p=="object"&&p.closeIcon?p.closeIcon:$||(S!==void 0?S:typeof O=="object"&&O.closeIcon?O.closeIcon:K),[S,p,O,$,K]),nt=a.useMemo(()=>{const Z=p??O;return typeof Z=="object"?we(Z,{data:!0,aria:!0}):{}},[p,O]);return a.createElement(ot,{visible:!V,motionName:`${N}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:Z=>({maxHeight:Z.offsetHeight}),onLeaveEnd:Ye??g},({className:Z,style:st},at)=>a.createElement("div",{id:v,ref:it(I,at),"data-show":!V,className:k(Qe,Z),style:{...ee.root,...q,...u,...st},onMouseEnter:x,onMouseLeave:h,onClick:l,role:"alert",...et},Se?a.createElement(tn,{className:k(`${N}-icon`,Q.icon),style:ee.icon,description:s,icon:t.icon,prefixCls:N,type:be,successIcon:J,infoIcon:L,warningIcon:f,errorIcon:_}):null,a.createElement("div",{className:k(`${N}-section`,Q.section),style:ee.section},D?a.createElement("div",{className:k(`${N}-title`,Q.title),style:ee.title},D):null,s?a.createElement("div",{className:k(`${N}-description`,Q.description),style:ee.description},s):null),T?a.createElement("div",{className:k(`${N}-actions`,Q.actions),style:ee.actions},T):null,a.createElement(nn,{className:Q.close,style:ee.close,isClosable:Ae,prefixCls:N,closeIcon:tt,handleClose:Je,ariaProps:nt})))});function sn(t,n,s){return n=Pe(n),mt(t,ht()?Reflect.construct(n,s||[],Pe(t).constructor):n.apply(t,s))}let an=(function(t){function n(){var s;return xt(this,n),s=sn(this,n,arguments),s.state={error:void 0,info:{componentStack:""}},s}return gt(n,t),pt(n,[{key:"componentDidCatch",value:function(r,c){this.setState({error:r,info:c})}},{key:"render",value:function(){const{message:r,title:c,description:d,id:m,children:o}=this.props,{error:i,info:u}=this.state,x=c??r,h=u?.componentStack||null,l=typeof x>"u"?(i||"").toString():x,g=typeof d>"u"?h:d;return i?a.createElement(We,{id:m,type:"error",title:l,description:a.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},g)}):o}}])})(a.Component);const ce=We;ce.ErrorBoundary=an;const rn=t=>{const{componentCls:n,iconCls:s,antCls:r,zIndexPopup:c,colorText:d,colorWarning:m,marginXXS:o,marginXS:i,fontSize:u,fontWeightStrong:x,colorTextHeading:h}=t;return{[n]:{zIndex:c,[`&${r}-popover`]:{fontSize:u},[`${n}-message`]:{marginBottom:i,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${n}-message-icon ${s}`]:{color:m,fontSize:u,lineHeight:1,marginInlineEnd:i},[`${n}-title`]:{fontWeight:x,color:h,"&:only-child":{fontWeight:"normal"}},[`${n}-description`]:{marginTop:o,color:d}},[`${n}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:i}}}}},on=t=>{const{zIndexPopupBase:n}=t;return{zIndexPopup:n+60}},Ve=xe("Popconfirm",t=>rn(t),on,{resetStyle:!1}),Ge=t=>{const{prefixCls:n,okButtonProps:s,cancelButtonProps:r,title:c,description:d,cancelText:m,okText:o,okType:i="primary",icon:u=a.createElement(Ee,null),showCancel:x=!0,close:h,onConfirm:l,onCancel:g,onPopupClick:y,classNames:p,styles:$}=t,{getPrefixCls:S}=a.useContext(Le),[T]=ft("Popconfirm",yt.Popconfirm),v=_e(c),w=_e(d);return a.createElement("div",{className:`${n}-inner-content`,onClick:y},a.createElement("div",{className:`${n}-message`},u&&a.createElement("span",{className:`${n}-message-icon`},u),a.createElement("div",{className:`${n}-message-text`},v&&a.createElement("div",{className:k(`${n}-title`,p?.title),style:$?.title},v),w&&a.createElement("div",{className:k(`${n}-description`,p?.content),style:$?.content},w))),a.createElement("div",{className:`${n}-buttons`},x&&a.createElement(U,{onClick:g,size:"small",...r},m||T?.cancelText),a.createElement(vt,{buttonProps:{size:"small",...jt(i),...s},actionFn:l,close:h,prefixCls:S("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},o||T?.okText)))},ln=t=>{const{prefixCls:n,placement:s,className:r,style:c,...d}=t,{getPrefixCls:m}=a.useContext(Le),o=m("popconfirm",n);return Ve(o),a.createElement(bt,{placement:s,className:k(o,r),style:c,content:a.createElement(Ge,{prefixCls:o,...d})})},cn=a.forwardRef((t,n)=>{const{prefixCls:s,placement:r="top",trigger:c,okType:d="primary",icon:m=a.createElement(Ee,null),children:o,overlayClassName:i,onOpenChange:u,overlayStyle:x,styles:h,arrow:l,classNames:g,...y}=t,{getPrefixCls:p,className:$,style:S,classNames:T,styles:v,arrow:w,trigger:C}=fe("popconfirm"),[z,D]=Re(t.defaultOpen??!1,t.open),V=St(l,w),j=c||C||"click",I=L=>{D(L),u?.(L)},A=()=>{I(!1)},E=L=>t.onConfirm?.call(void 0,L),O=L=>{I(!1),t.onCancel?.call(void 0,L)},K=L=>{const{disabled:f=!1}=t;f||I(L)},B=p("popconfirm",s),q={...t,placement:r,trigger:j,okType:d,overlayStyle:x,styles:h,classNames:g},[P,W]=ye([T,g],[v,h],{props:q}),J=k(B,$,i,P.root);return Ve(B),a.createElement(wt,{arrow:V,...Ct(y,["title"]),trigger:j,placement:r,onOpenChange:K,open:z,ref:n,classNames:{root:J,container:P.container,arrow:P.arrow},styles:{root:{...S,...W.root,...x},container:W.container,arrow:W.arrow},content:a.createElement(Ge,{okType:d,icon:m,...t,prefixCls:B,close:A,onConfirm:E,onCancel:O,classNames:P,styles:W}),"data-popover-inject":!0},o)}),se=cn;se._InternalPanelDoNotUseOrYouWillBeFired=ln;var dn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};function $e(){return $e=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},$e.apply(this,arguments)}const un=(t,n)=>a.createElement(Ue,$e({},t,{ref:n,icon:dn})),mn=a.forwardRef(un),hn=t=>{const{value:n,formatter:s,precision:r,decimalSeparator:c,groupSeparator:d="",prefixCls:m}=t;let o;if(typeof s=="function")o=s(n);else{const i=String(n),u=i.match(/^(-?)(\d*)(\.(\d+))?$/);if(!u||i==="-")o=i;else{const x=u[1];let h=u[2]||"0",l=u[4]||"";h=h.replace(/\B(?=(\d{3})+(?!\d))/g,d),typeof r=="number"&&(l=l.padEnd(r,"0").slice(0,r>0?r:0)),l&&(l=`${c}${l}`),o=[a.createElement("span",{key:"int",className:`${m}-content-value-int`},x,h),l&&a.createElement("span",{key:"decimal",className:`${m}-content-value-decimal`},l)]}}return a.createElement("span",{className:`${m}-content-value`},o)},gn=t=>{const{componentCls:n,marginXXS:s,padding:r,colorTextDescription:c,titleFontSize:d,colorTextHeading:m,contentFontSize:o,fontFamily:i}=t;return{[n]:{...Te(t),[`${n}-header`]:{paddingBottom:s,[`${n}-title`]:{color:c,fontSize:d}},[`${n}-skeleton`]:{paddingTop:r},[`${n}-content`]:{color:m,fontSize:o,fontFamily:i,[`${n}-content-value`]:{display:"inline-block",direction:"ltr"},[`${n}-content-prefix, ${n}-content-suffix`]:{display:"inline-block"},[`${n}-content-prefix`]:{marginInlineEnd:s},[`${n}-content-suffix`]:{marginInlineStart:s}}}}},pn=t=>{const{fontSizeHeading3:n,fontSize:s}=t;return{titleFontSize:s,contentFontSize:n}},xn=xe("Statistic",t=>{const n=He(t,{});return gn(n)},pn),te=a.forwardRef((t,n)=>{const{prefixCls:s,className:r,rootClassName:c,style:d,valueStyle:m,value:o=0,title:i,valueRender:u,prefix:x,suffix:h,loading:l=!1,formatter:g,precision:y,decimalSeparator:p=".",groupSeparator:$=",",onMouseEnter:S,onMouseLeave:T,styles:v,classNames:w,...C}=t,{getPrefixCls:z,direction:D,className:V,style:j,classNames:I,styles:A}=fe("statistic"),E=z("statistic",s),[O,K]=xn(E),B={...t,decimalSeparator:p,groupSeparator:$,loading:l,value:o},[q,P]=ye([I,w],[A,v],{props:B}),W=a.createElement(hn,{decimalSeparator:p,groupSeparator:$,prefixCls:E,formatter:g,precision:y,value:o}),J=k(E,{[`${E}-rtl`]:D==="rtl"},V,r,c,q.root,O,K),L=k(`${E}-header`,q.header),f=k(`${E}-title`,q.title),_=k(`${E}-content`,q.content),N=k(`${E}-content-prefix`,q.prefix),ve=k(`${E}-content-suffix`,q.suffix),de=a.useRef(null);a.useImperativeHandle(n,()=>({nativeElement:de.current}));const je=we(C,{aria:!0,data:!0});return a.createElement("div",{...je,className:J,style:{...P.root,...j,...d},ref:de,onMouseEnter:S,onMouseLeave:T},i&&a.createElement("div",{className:L,style:P.header},a.createElement("div",{className:f,style:P.title},i)),a.createElement($t,{paragraph:!1,loading:l,className:`${E}-skeleton`,active:!0},a.createElement("div",{className:_,style:{...m,...P.content}},x&&a.createElement("span",{className:N,style:P.prefix},x),u?u(W):W,h&&a.createElement("span",{className:ve,style:P.suffix},h))))}),fn=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function yn(t,n){let s=t;const r=/\[[^\]]*]/g,c=(n.match(r)||[]).map(i=>i.slice(1,-1)),d=n.replace(r,"[]"),m=fn.reduce((i,[u,x])=>{if(i.includes(u)){const h=Math.floor(s/x);return s-=h*x,i.replace(new RegExp(`${u}+`,"g"),l=>{const g=l.length;return h.toString().padStart(g,"0")})}return i},d);let o=0;return m.replace(r,()=>{const i=c[o];return o+=1,i})}function vn(t,n,s){const{format:r=""}=n,c=new Date(t).getTime(),d=Date.now(),m=Math.max(s?c-d:d-c,0);return yn(m,r)}const jn=1e3/60;function bn(t){return new Date(t).getTime()}const Xe=t=>{const{value:n,format:s="HH:mm:ss",onChange:r,onFinish:c,type:d,...m}=t,o=d==="countdown",[i,u]=a.useState(null),x=It(()=>{const g=Date.now(),y=bn(n);u({});const p=o?y-g:g-y;return r?.(p),o&&y<g?(c?.(),!1):!0});a.useEffect(()=>{let g;const y=()=>{x()||window.clearInterval(g)},p=()=>{g=window.setInterval(y,jn)},$=()=>{window.clearInterval(g)};return p(),()=>{$()}},[n,o]),a.useEffect(()=>{u({})},[]);const h=(g,y)=>i?vn(g,{...y,format:s},o):"-",l=g=>Nt(g,{title:void 0});return a.createElement(te,{...m,value:n,valueRender:l,formatter:h})},Sn=t=>a.createElement(Xe,{...t,type:"countdown"}),wn=a.memo(Sn);te.Timer=Xe;te.Countdown=wn;function Ie(){return Ie=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Ie.apply(this,arguments)}const Ke=a.forwardRef(({prefixCls:t="rc-switch",className:n,checked:s,defaultChecked:r,disabled:c,loadingIcon:d,checkedChildren:m,unCheckedChildren:o,onClick:i,onChange:u,onKeyDown:x,styles:h,classNames:l,...g},y)=>{const[p,$]=Re(r??!1,s);function S(C,z){let D=p;return c||(D=C,$(D),u?.(D,z)),D}function T(C){C.which===ze.LEFT?S(!1,C):C.which===ze.RIGHT&&S(!0,C),x?.(C)}function v(C){const z=S(!p,C);i?.(z,C)}const w=k(t,n,{[`${t}-checked`]:p,[`${t}-disabled`]:c});return a.createElement("button",Ie({},g,{type:"button",role:"switch","aria-checked":p,disabled:c,className:w,ref:y,onKeyDown:T,onClick:v}),d,a.createElement("span",{className:`${t}-inner`},a.createElement("span",{className:k(`${t}-inner-checked`,l?.content),style:h?.content},m),a.createElement("span",{className:k(`${t}-inner-unchecked`,l?.content),style:h?.content},o)))});Ke.displayName="Switch";const Cn=t=>{const{componentCls:n,trackHeightSM:s,trackPadding:r,trackMinWidthSM:c,innerMinMarginSM:d,innerMaxMarginSM:m,handleSizeSM:o,calc:i}=t,u=`${n}-inner`,x=Y(i(o).add(i(r).mul(2)).equal()),h=Y(i(m).mul(2).equal());return{[n]:{[`&${n}-small`]:{minWidth:c,height:s,lineHeight:Y(s),[`${n}-inner`]:{paddingInlineStart:m,paddingInlineEnd:d,[`${u}-checked, ${u}-unchecked`]:{minHeight:s},[`${u}-checked`]:{marginInlineStart:`calc(-100% + ${x} - ${h})`,marginInlineEnd:`calc(100% - ${x} + ${h})`},[`${u}-unchecked`]:{marginTop:i(s).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${n}-handle`]:{width:o,height:o},[`${n}-loading-icon`]:{top:i(i(o).sub(t.switchLoadingIconSize)).div(2).equal(),fontSize:t.switchLoadingIconSize},[`&${n}-checked`]:{[`${n}-inner`]:{paddingInlineStart:d,paddingInlineEnd:m,[`${u}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${u}-unchecked`]:{marginInlineStart:`calc(100% - ${x} + ${h})`,marginInlineEnd:`calc(-100% + ${x} - ${h})`}},[`${n}-handle`]:{insetInlineStart:`calc(100% - ${Y(i(o).add(r).equal())})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${u}`]:{[`${u}-unchecked`]:{marginInlineStart:i(t.marginXXS).div(2).equal(),marginInlineEnd:i(t.marginXXS).mul(-1).div(2).equal()}},[`&${n}-checked ${u}`]:{[`${u}-checked`]:{marginInlineStart:i(t.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:i(t.marginXXS).div(2).equal()}}}}}}},$n=t=>{const{componentCls:n,handleSize:s,calc:r}=t;return{[n]:{[`${n}-loading-icon${t.iconCls}`]:{position:"relative",top:r(r(s).sub(t.fontSize)).div(2).equal(),color:t.switchLoadingIconColor,verticalAlign:"top"},[`&${n}-checked ${n}-loading-icon`]:{color:t.switchColor}}}},In=t=>{const{componentCls:n,trackPadding:s,handleBg:r,handleShadow:c,handleSize:d,calc:m}=t,o=`${n}-handle`;return{[n]:{[o]:{position:"absolute",top:s,insetInlineStart:s,width:d,height:d,transition:`all ${t.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:r,borderRadius:m(d).div(2).equal(),boxShadow:c,transition:`all ${t.switchDuration} ease-in-out`,content:'""'}},[`&${n}-checked ${o}`]:{insetInlineStart:`calc(100% - ${Y(m(d).add(s).equal())})`},[`&:not(${n}-disabled):active`]:{[`${o}::before`]:{insetInlineEnd:t.switchHandleActiveInset,insetInlineStart:0},[`&${n}-checked ${o}::before`]:{insetInlineEnd:0,insetInlineStart:t.switchHandleActiveInset}}}}},Nn=t=>{const{componentCls:n,trackHeight:s,trackPadding:r,innerMinMargin:c,innerMaxMargin:d,handleSize:m,calc:o}=t,i=`${n}-inner`,u=Y(o(m).add(o(r).mul(2)).equal()),x=Y(o(d).mul(2).equal());return{[n]:{[i]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:d,paddingInlineEnd:c,transition:`padding-inline-start ${t.switchDuration} ease-in-out, padding-inline-end ${t.switchDuration} ease-in-out`,[`${i}-checked, ${i}-unchecked`]:{display:"block",color:t.colorTextLightSolid,fontSize:t.fontSizeSM,transition:`margin-inline-start ${t.switchDuration} ease-in-out, margin-inline-end ${t.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:s},[`${i}-checked`]:{marginInlineStart:`calc(-100% + ${u} - ${x})`,marginInlineEnd:`calc(100% - ${u} + ${x})`},[`${i}-unchecked`]:{marginTop:o(s).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${n}-checked ${i}`]:{paddingInlineStart:c,paddingInlineEnd:d,[`${i}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${i}-unchecked`]:{marginInlineStart:`calc(100% - ${u} + ${x})`,marginInlineEnd:`calc(-100% + ${u} - ${x})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${i}`]:{[`${i}-unchecked`]:{marginInlineStart:o(r).mul(2).equal(),marginInlineEnd:o(r).mul(-1).mul(2).equal()}},[`&${n}-checked ${i}`]:{[`${i}-checked`]:{marginInlineStart:o(r).mul(-1).mul(2).equal(),marginInlineEnd:o(r).mul(2).equal()}}}}}},kn=t=>{const{componentCls:n,trackHeight:s,trackMinWidth:r}=t;return{[n]:{...Te(t),position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:r,height:s,lineHeight:Y(s),verticalAlign:"middle",background:t.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${t.motionDurationMid}`,userSelect:"none",[`&:hover:not(${n}-disabled)`]:{background:t.colorTextTertiary},...kt(t),[`&${n}-checked`]:{background:t.switchColor,[`&:hover:not(${n}-disabled)`]:{background:t.colorPrimaryHover}},[`&${n}-loading, &${n}-disabled`]:{cursor:"not-allowed",opacity:t.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${n}-rtl`]:{direction:"rtl"}}}},Tn=t=>{const{fontSize:n,lineHeight:s,controlHeight:r,colorWhite:c}=t,d=n*s,m=r/2,o=2,i=d-o*2,u=m-o*2;return{trackHeight:d,trackHeightSM:m,trackMinWidth:i*2+o*4,trackMinWidthSM:u*2+o*2,trackPadding:o,handleBg:c,handleSize:i,handleSizeSM:u,handleShadow:`0 2px 4px 0 ${new Tt("#00230b").setA(.2).toRgbString()}`,innerMinMargin:i/2,innerMaxMargin:i+o+o*2,innerMinMarginSM:u/2,innerMaxMarginSM:u+o+o*2}},En=xe("Switch",t=>{const n=He(t,{switchDuration:t.motionDurationMid,switchColor:t.colorPrimary,switchDisabledOpacity:t.opacityLoading,switchLoadingIconSize:t.calc(t.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${t.opacityLoading})`,switchHandleActiveInset:"-30%"});return[kn(n),Nn(n),In(n),$n(n),Cn(n)]},Tn),Rn=a.forwardRef((t,n)=>{const{prefixCls:s,size:r,disabled:c,loading:d,className:m,rootClassName:o,style:i,checked:u,value:x,defaultChecked:h,defaultValue:l,onChange:g,styles:y,classNames:p,...$}=t,[S,T]=Re(h??l??!1,u??x),{getPrefixCls:v,direction:w,className:C,style:z,classNames:D,styles:V}=fe("switch"),j=a.useContext(Et),I=(c??j)||d,A=v("switch",s),E=a.createElement("div",{className:`${A}-handle`},d&&a.createElement(Mt,{className:`${A}-loading-icon`})),[O,K]=En(A),B=Rt(r),q={...t,size:B,disabled:I},[P,W]=ye([D,p],[V,y],{props:q}),J=k(C,{[`${A}-small`]:B==="small",[`${A}-loading`]:d,[`${A}-rtl`]:w==="rtl"},m,o,P.root,O,K),L={...W.root,...z,...i},f=(..._)=>{T(_[0]),g?.(..._)};return a.createElement(Ut,{component:"Switch",disabled:I},a.createElement(Ke,{...$,classNames:P,styles:W,checked:S,onChange:f,prefixCls:A,className:J,style:L,disabled:I,ref:n,loadingIcon:E}))}),Me=Rn;Me.__ANT_SWITCH=!0;const Un=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Mn=At("ban",Un);var An={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};function Ne(){return Ne=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Ne.apply(this,arguments)}const Pn=(t,n)=>a.createElement(Ue,Ne({},t,{ref:n,icon:An})),_n=a.forwardRef(Pn);var zn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 642.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 505 759.6 431.7 759.6 349c0-137-110.8-248-247.5-248S264.7 212 264.7 349c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 888.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 628.2 432.2 597 512.2 597c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 521c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 349c0-45.9 17.9-89.1 50.3-121.6S466.3 177 512.2 177s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 349c0 45.9-17.9 89.1-50.3 121.6C601.1 503.1 558 521 512.2 521zM880 759h-84v-84c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v84h-84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h84v84c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-84h84c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-add",theme:"outlined"};function ke(){return ke=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},ke.apply(this,arguments)}const Dn=(t,n)=>a.createElement(Ue,ke({},t,{ref:n,icon:zn})),On=a.forwardRef(Dn),{Title:X,Text:b,Paragraph:R}=Gt;function rs(){const{appId:t}=Pt(),n=_t(),[s,r]=a.useState(null),[c,d]=a.useState(!1);a.useEffect(()=>{t&&m()},[t]);const m=async()=>{d(!0);try{const{data:i}=await M.get(`/apps/details?id=${t}`);r(i.data)}catch{ae.useApp().message.error("Could not load app details"),n("/dashboard")}finally{d(!1)}};if(c)return e.jsx(zt,{});if(!s)return e.jsx(Ft,{});const o=[{key:"stats",label:"Analytics",children:e.jsx(Vn,{app:s})},{key:"security",label:"Security",children:e.jsx(Fn,{app:s})},{key:"members",label:"Members",children:e.jsx(Ln,{app:s})},{key:"help",label:"Integration Guide",children:e.jsx(Bn,{app:s})},{key:"settings",label:"Settings",children:e.jsx(Hn,{app:s,onUpdate:m,onDelete:()=>n("/dashboard")})}];return e.jsxs(ie,{className:"max-w-5xl w-full shadow-xl",title:"Manage Application",extra:e.jsx(U,{icon:e.jsx(Xt,{}),onClick:()=>n(-1),children:"Back"}),children:[e.jsxs(G,{size:10,align:"center",className:"mb-3",children:[e.jsx(Dt,{size:48,url:{url:s.logoUrl,text:s.name}}),e.jsx(X,{level:3,style:{marginBottom:0},children:s.name}),e.jsx(qe,{color:"blue",children:s.role})]}),s.suspendUntil&&Ce(s.suspendUntil).isAfter(Ce())&&e.jsx(ce,{type:"error",title:"This app is suspended until "+oe(s.suspendUntil)}),e.jsx(Be,{defaultActiveKey:"stats",items:o})]})}function Fn({app:t}){const{message:n}=ae.useApp(),[s,r]=a.useState([]),[c,d]=a.useState(!1),[m,o]=a.useState(!1),[i,u]=a.useState(""),[x,h]=a.useState(""),[l,g]=a.useState(t.deviceCodeEnabled??!0),[y,p]=a.useState(!1),[$,S]=a.useState([]),[T,v]=a.useState(!1),[w,C]=a.useState(!1),[z,D]=a.useState(null),[V,j]=a.useState(!1),[I,A]=a.useState("");a.useEffect(()=>{B(),t.role!=="external"&&E()},[t.id]),a.useEffect(()=>{g(t.deviceCodeEnabled??!0)},[t.deviceCodeEnabled]);const E=async()=>{v(!0);try{const{data:f}=await M.get(`/apps/secrets?id=${t.id}`);S(f.data||[])}catch{}finally{v(!1)}},O=async()=>{if(!I.trim()){n.error("Please enter a name for the secret");return}try{const{data:f}=await M.post("/apps/secrets/create",{appId:t.id,name:I});D(f.data),C(!0),j(!1),A(""),E()}catch(f){n.error(f.response?.data?.message||"Failed to create secret")}},K=async f=>{try{await M.post("/apps/secrets/delete",{appId:t.id,secretId:f}),n.success("Secret deleted"),E()}catch(_){n.error(_.response?.data?.message||"Failed to delete secret")}},B=async()=>{d(!0);try{const{data:f}=await M.get(`/apps/uris?id=${t.id}`);r(f.data||[])}catch{}finally{d(!1)}},q=async()=>{const f=x.trim();if(!f){n.error("URI is required");return}try{await M.post("/apps/uris/add",{appId:t.id,name:i.trim(),uri:f}),n.success("Trusted URI added"),o(!1),u(""),h(""),B()}catch(_){const N=_.response?.data?.message||"Failed to add trusted URI";n.error(N)}},P=async f=>{try{await M.post("/apps/uris/delete",{appId:t.id,uriId:f}),n.success("Trusted URI removed"),B()}catch(_){const N=_.response?.data?.message||"Failed to remove trusted URI";n.error(N)}},W=async f=>{p(!0);try{await M.post("/apps/device-code/toggle",{appId:t.id,enabled:f}),g(f),n.success(`Device code flow ${f?"enabled":"disabled"}`)}catch(_){const N=_.response?.data?.message||"Failed to update device code settings";n.error(N),g(!f)}finally{p(!1)}},J=[{title:"Name",dataIndex:"name",key:"name",render:f=>f||e.jsx(b,{type:"secondary",children:"Unnamed"})},{title:"URI",dataIndex:"uri",key:"uri",render:f=>e.jsx(b,{copyable:!0,children:f})},{title:"Added At",dataIndex:"createdAt",key:"createdAt",render:f=>oe(f)},{title:"Action",key:"action",render:(f,_)=>e.jsx(se,{title:"Delete this URI?",onConfirm:()=>P(_.id),okText:"Yes",cancelText:"No",children:e.jsx(U,{type:"text",danger:!0,icon:e.jsx(le,{})})})}],L=[{title:"Description",dataIndex:"name",key:"name",render:f=>f||e.jsx(b,{type:"secondary",children:"No description"})},{title:"Created",dataIndex:"createdAt",key:"createdAt",render:f=>oe(f)},{title:"Last Used",dataIndex:"lastUsedAt",key:"lastUsedAt",render:f=>f?oe(f):e.jsx(b,{type:"secondary",children:"Never"})},{title:"Action",key:"action",render:(f,_)=>e.jsx(se,{title:"Delete client secret?",description:"This action cannot be undone.",onConfirm:()=>K(_.id),okText:"Delete",cancelText:"Cancel",children:e.jsx(U,{type:"text",danger:!0,icon:e.jsx(le,{})})})}];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(b,{type:"secondary",children:"Client ID"}),e.jsxs(F.Group,{compact:!0,children:[e.jsx(F,{style:{width:"calc(100% - 32px)"},value:t.id,readOnly:!0}),e.jsx(U,{icon:e.jsx(Oe,{}),onClick:()=>{navigator.clipboard.writeText(t.id),n.success("Client ID copied")}})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-6",children:[e.jsx(b,{children:"Manage client secrets for confidential client flows."}),e.jsx(U,{type:"primary",icon:e.jsx(De,{}),onClick:()=>j(!0),disabled:t.role==="external",children:"New Client Secret"})]}),e.jsx(pe,{dataSource:$,columns:L,rowKey:"id",pagination:!1,loading:T}),e.jsx(ge,{title:"Generate New Client Secret",open:V,onCancel:()=>j(!1),onOk:O,okText:"Generate",children:e.jsx(H,{layout:"vertical",children:e.jsx(H.Item,{label:"Description",required:!0,help:"Give this secret a name (e.g. 'Production Server', 'Dev Test')",children:e.jsx(F,{value:I,onChange:f=>A(f.target.value),placeholder:"My App Secret",onPressEnter:O,autoFocus:!0})})})}),e.jsxs(ge,{title:"Client Secret Generated",open:w,footer:[e.jsx(U,{type:"primary",onClick:()=>C(!1),children:"Done"},"ok")],closable:!1,maskClosable:!1,children:[e.jsx(b,{type:"warning",children:"Make sure to copy this client secret now. You won't be able to see it again!"}),e.jsxs(G.Compact,{className:"w-full mt-4",children:[e.jsx(F,{readOnly:!0,value:z?.secret}),e.jsx(U,{icon:e.jsx(Oe,{}),onClick:()=>{z?.secret&&(navigator.clipboard.writeText(z.secret),n.success("Copied!"))}})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-6",children:[e.jsx("div",{children:e.jsx(b,{children:"Manage redirect URIs allowed by Authorization Code flow."})}),e.jsx(U,{type:"primary",icon:e.jsx(De,{}),onClick:()=>o(!0),disabled:t.role==="external",children:"Add URI"})]}),e.jsx(pe,{dataSource:s,columns:J,rowKey:"id",loading:c,pagination:!1}),e.jsx(ie,{size:"small",children:e.jsx(G,{direction:"vertical",style:{width:"100%"},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(b,{strong:!0,children:"Device Code Flow"}),e.jsx("br",{}),e.jsx(b,{type:"secondary",style:{fontSize:"12px"},children:"Allow this application to use Device Code flow for authentication."})]}),e.jsx(Me,{checked:l,onChange:W,loading:y,disabled:t.role==="external"})]})})}),e.jsxs(ge,{title:"Add Trusted URI",open:m,onCancel:()=>{o(!1),u(""),h("")},onOk:q,okText:"Add",children:[e.jsxs(H,{layout:"vertical",children:[e.jsx(H.Item,{label:"Name",children:e.jsx(F,{placeholder:"e.g. Local dev callback",value:i,onChange:f=>u(f.target.value)})}),e.jsx(H.Item,{label:"URI",required:!0,children:e.jsx(F,{placeholder:"https://example.com/callback",value:x,onChange:f=>h(f.target.value)})})]}),e.jsx(R,{children:"Enter full URI including scheme. Wildcards(*) are not allowed."})]})]})}function Ln({app:t}){const[n,s]=a.useState([]),[r,c]=a.useState(!1),[d,m]=a.useState(!1),[o,i]=a.useState(""),[u,x]=a.useState("admin"),{message:h}=ae.useApp(),{profile:l}=Ot();a.useEffect(()=>{g()},[t.id]);const g=async()=>{c(!0);try{const{data:v}=await M.get(`/apps/members?id=${t.id}`);s(v.data||[])}catch{}finally{c(!1)}},y=async()=>{try{await M.post("/apps/members/add",{appId:t.id,username:o,role:u}),h.success("Member added"),m(!1),i(""),g()}catch(v){const w=v.response?.data?.message||"Failed to add member";h.error(w)}},p=async v=>{try{await M.post("/apps/members/remove",{appId:t.id,username:v}),h.success("Member removed"),g()}catch{h.error("Failed to remove member")}},$=async(v,w)=>{try{await M.post("/apps/members/role",{appId:t.id,username:v,role:w}),h.success("Role updated"),g()}catch{h.error("Failed to update role")}},S=[{label:"Admin",value:"admin"},{label:"Root",value:"root"}],T=[{title:"Username",dataIndex:"username",key:"username"},{title:"Role",dataIndex:"role",key:"role",render:v=>e.jsx(qe,{color:v==="root"?"gold":"blue",children:v})},{title:"Action",key:"action",render:(v,w)=>w.username===l?.username?e.jsx(G,{children:e.jsx(se,{title:"Remove yourself? You'll lose access to this app!",onConfirm:()=>p(w.username),okText:"Yes",cancelText:"No",children:e.jsx(U,{danger:!0,size:"small",icon:e.jsx(le,{}),children:"Leave"})})}):t.role!=="root"?e.jsx(Mn,{size:18}):e.jsxs(G,{children:[e.jsx(ue,{value:w.role,onChange:C=>$(w.username,C),options:S,size:"small",className:"w-20"}),e.jsx(se,{title:`Remove ${w.username} from this app?`,onConfirm:()=>p(w.username),okText:"Yes",cancelText:"No",children:e.jsx(U,{danger:!0,size:"small",icon:e.jsx(le,{})})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(b,{children:"Manage team members and their access levels."}),t.role==="root"&&e.jsx(U,{type:"primary",icon:e.jsx(On,{}),onClick:()=>m(!0),children:"Add Member"})]}),e.jsx(pe,{dataSource:n,columns:T,rowKey:"username",loading:r,pagination:!1}),e.jsx(ge,{title:"Add New Member",open:d,onCancel:()=>m(!1),onOk:y,okText:"Add",children:e.jsxs(H,{layout:"vertical",children:[e.jsx(H.Item,{label:"Username",required:!0,children:e.jsx(F,{value:o,onChange:v=>i(v.target.value),placeholder:"Username"})}),e.jsx(H.Item,{label:"Role",required:!0,children:e.jsxs(ue,{value:u,onChange:x,children:[e.jsx(ue.Option,{value:"admin",children:"Admin"}),e.jsx(ue.Option,{value:"root",children:"Root"})]})})]})})]})}function Hn({app:t,onUpdate:n,onDelete:s}){const{message:r}=ae.useApp(),[c]=H.useForm(),[d,m]=a.useState(!1),[o,i]=a.useState(null);a.useEffect(()=>{c.setFieldsValue({name:t.name,description:t.description,logoUrl:t.logoUrl}),i(null)},[t]);const u=async l=>{m(!0);try{if(o){const g=new FormData;g.append("appId",t.id),g.append("name",l.name),g.append("description",l.description||""),g.append("logoUrl",l.logoUrl||""),g.append("file",o),await M.post("/apps/update",g,{headers:{"Content-Type":"multipart/form-data"}})}else await M.post("/apps/update",{appId:t.id,name:l.name,description:l.description,logoUrl:l.logoUrl});r.success("App updated"),n(),i(null)}catch(g){const y=g;console.error("Failed to update app",y.response),r.error(y.response?.data?.error||"Failed to update app")}finally{m(!1)}},x=async()=>{try{await M.post("/apps/delete",{appId:t.id}),r.success("App deleted"),s()}catch(l){const g=l.response?.data?.message||"Failed to delete app";r.error(g)}},h=t.role==="root";return e.jsxs("div",{className:"max-w-3xl",children:[e.jsx(X,{level:4,children:"General Settings"}),e.jsxs(H,{form:c,layout:"vertical",onFinish:u,children:[e.jsx(H.Item,{label:"App Name",name:"name",rules:[{required:!0,message:"Please input app name!"}],children:e.jsx(F,{})}),e.jsx(H.Item,{label:"Description",name:"description",children:e.jsx(F.TextArea,{rows:4})}),e.jsx(H.Item,{label:"Logo URL",children:e.jsxs(G.Compact,{style:{width:"100%"},children:[e.jsx(H.Item,{name:"logoUrl",noStyle:!0,children:e.jsx(F,{placeholder:"https://example.com/logo.png"})}),e.jsx(Lt,{rotationSlider:!0,children:e.jsx(qt,{showUploadList:!1,customRequest:({file:l,onSuccess:g})=>{const y=l;i(y);const p=URL.createObjectURL(y);c.setFieldValue("logoUrl",p),r.success("Logo selected. Click Save to apply."),g?.("ok")},children:e.jsx(U,{icon:e.jsx(Wt,{}),children:"Select"})})})]})}),e.jsx(H.Item,{children:e.jsx(U,{type:"primary",htmlType:"submit",icon:e.jsx(_n,{}),loading:d,children:"Save Changes"})})]}),h&&e.jsxs(e.Fragment,{children:[e.jsx(Kt,{}),e.jsxs("div",{className:"border border-red-200 dark:border-red-900 p-4 rounded-lg bg-red-50 dark:bg-red-900/20",children:[e.jsx(X,{level:5,type:"danger",children:"Danger Zone"}),e.jsx(R,{children:"Deleting this application will remove all associated data, including API keys and member associations. This action cannot be undone."}),e.jsx(se,{title:"Are you sure you want to delete this app?",description:"This action cannot be undone.",onConfirm:x,okText:"Yes, delete it",okType:"danger",cancelText:"Cancel",children:e.jsx(U,{type:"primary",danger:!0,icon:e.jsx(le,{}),children:"Delete Application"})})]})]})]})}function Bn({app:t}){const n=[{key:"authcode",label:"Authorization Code Flow",children:e.jsx(qn,{app:t})},{key:"device",label:"Device Code Flow",children:e.jsx(Wn,{app:t})}];let s=re.API_URL;return s.endsWith("/")&&(s=s.slice(0,-1)),e.jsx("div",{className:"max-w-4xl space-y-8",children:e.jsxs("div",{children:[e.jsx(X,{level:3,children:"Integration Guide"}),e.jsxs(R,{children:["Select the authentication flow that best suits your application. For a more detailed guide, please refer to"," ",e.jsx("a",{href:"https://github.com/mirpri/mirpass/tree/master/guide",target:"_blank",children:"Guide"}),"."]}),e.jsxs(R,{children:["Discovery document is available at"," ",e.jsxs("a",{href:`${s}/.well-known/openid-configuration`,target:"_blank",children:[s,"/.well-known/openid-configuration"]}),"."]}),e.jsx(Be,{items:n})]})})}function qn({app:t}){let n=re.API_URL;n.endsWith("/")&&(n=n.slice(0,-1));const{message:s}=ae.useApp(),[r,c]=a.useState(""),[d,m]=a.useState(me(16)),[o,i]=a.useState(me(43)),[u,x]=a.useState(""),[h,l]=a.useState(!0),[g,y]=a.useState(""),[p,$]=a.useState(""),[S,T]=a.useState(null),[v,w]=a.useState(null);a.useEffect(()=>{h?Vt(o).then(x):x("")},[o,h]);const C=()=>{const j=me(43);i(j),m(me(16))},z=()=>{const j=new URLSearchParams({response_type:"code",client_id:t.id,redirect_uri:r,state:d});h&&(j.append("code_challenge",u),j.append("code_challenge_method","S256"));const I=`${re.API_URL}/oauth2/authorize?${j.toString()}`;window.open(I,"_blank"),s.info("Opens provider authorization page. After approval, copy the 'code' from the URL.")},D=async()=>{if(!p){s.error("Please enter the authorization code");return}const j={grant_type:"authorization_code",client_id:t.id,code:p};h?j.code_verifier=o:g&&(j.client_secret=g);try{const{data:I}=await M.post("/oauth2/token",new URLSearchParams(j));T(I),s.success("Token exchanged successfully!")}catch(I){const A=I.response?.data?.error||"Failed to exchange token";s.error(A),T({error:A})}},V=async()=>{if(S?.access_token)try{const j=await fetch(`${re.API_URL}/userinfo`,{headers:{Authorization:`Bearer ${S.access_token}`}});if(j.ok){const I=await j.json();w(I),s.success("User info fetched")}else s.error("Failed to fetch user info")}catch{s.error("Error fetching user info")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(ce,{title:"Recommended for Web / Mobile Apps",description:"Authorization Code Flow is the most secure method for authenticating users. PKCE is recommended for public clients.",type:"info",showIcon:!0}),e.jsxs(G,{direction:"vertical",className:"w-full bg-gray-50 dark:bg-gray-900/20 p-4 rounded border border-gray-200 dark:border-gray-700 mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(X,{level:4,style:{margin:0},children:"Test Authorization Code Flow"}),e.jsxs(G,{children:[e.jsx(b,{children:"Use PKCE"}),e.jsx(Me,{checked:h,onChange:l})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(b,{strong:!0,children:"Client ID"}),e.jsx(F,{value:t.id,disabled:!0})]}),e.jsxs("div",{children:[e.jsx(b,{strong:!0,children:"Redirect URI"}),e.jsx(F,{value:r,onChange:j=>c(j.target.value)})]}),e.jsxs("div",{children:[e.jsx(b,{strong:!0,children:"State (Random)"}),e.jsx(F,{value:d,disabled:!0})]}),h?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(b,{strong:!0,children:"Code Verifier (PKCE)"}),e.jsxs(G.Compact,{style:{width:"100%"},children:[e.jsx(F,{value:o,disabled:!0}),e.jsx(U,{icon:e.jsx(mn,{}),onClick:C})]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsx(b,{strong:!0,children:"Code Challenge (S256(Verifier))"}),e.jsx(F,{value:u,disabled:!0})]})]}):e.jsxs("div",{children:[e.jsx(b,{strong:!0,children:"Client Secret"}),e.jsx(F,{value:g,onChange:j=>y(j.target.value)})]})]}),e.jsx(U,{type:"primary",onClick:z,disabled:h&&!u,children:"Simulate authorization request"}),e.jsxs(R,{className:"mb-0",children:["After approval, copy the ",e.jsx("code",{children:"code"})," query value from your redirect URI."]}),e.jsxs(G.Compact,{style:{width:"100%"},children:[e.jsx(F,{placeholder:"Paste authorization code here...",value:p,onChange:j=>$(j.target.value)}),e.jsx(U,{type:"primary",onClick:D,disabled:!p,children:"Exchange token"})]}),S&&e.jsxs("div",{className:"mt-2 bg-green-50 dark:bg-green-900/20 p-4 rounded border border-green-200",children:[e.jsx(b,{strong:!0,className:"text-green-600",children:"Token Response:"}),e.jsx("div",{className:"my-2 bg-gray-100 dark:bg-gray-800 p-3 rounded text-sm text-gray-600 dark:text-gray-300 font-mono overflow-x-auto",children:JSON.stringify(S,null,2)}),e.jsx(U,{onClick:V,children:"Fetch User Info with this Token"})]}),v&&e.jsxs("div",{className:"mt-2 bg-blue-50 dark:bg-blue-900/20 p-4 rounded border border-blue-200",children:[e.jsx(b,{strong:!0,className:"text-blue-600",children:"User Info:"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 p-3 rounded text-sm text-gray-600 dark:text-gray-300 font-mono overflow-x-auto",children:JSON.stringify(v,null,2)})]})]}),e.jsxs("div",{children:[e.jsx(X,{level:4,children:"1. Initiate Authorization"}),e.jsx(R,{children:"Send the user to the authorization endpoint."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"GET"})," ",n,"/oauth2/authorize",e.jsx("br",{}),"?client_id=",t.id,e.jsx("br",{}),"&response_type=code",e.jsx("br",{}),"&redirect_uri=",encodeURIComponent(r),e.jsx("br",{}),"&state=",encodeURIComponent(d),h&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"&code_challenge=",u,e.jsx("br",{}),"&code_challenge_method=S256"]})]})]}),e.jsx(ce,{title:"The redirected_uri must match one of the app's registered trusted URIs. Add trusted URIs in the Security tab.",type:"warning",showIcon:!0}),e.jsxs("div",{className:"mt-6",children:[e.jsx(X,{level:4,children:"2. Exchange Code for Token"}),e.jsx(R,{children:"Exchange the received code for tokens."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"POST"})," ",n,"/oauth2/token",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"Content-Type:"})," application/x-www-form-urlencoded",e.jsx("br",{}),e.jsx("br",{}),"grant_type=authorization_code",e.jsx("br",{}),"&client_id=",t.id,e.jsx("br",{}),"&code=",p||"AUTHORIZATION_CODE",h?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"&code_verifier=",o]}):g?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"&client_secret=YOUR_SECRET"]}):null]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx(X,{level:4,children:"3. Get User Profile"}),e.jsx(R,{children:"Use the access token to get user information."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"GET"})," ",n,"/userinfo",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"Authorization:"})," Bearer"," ",S?.access_token||"ACCESS_TOKEN"]}),e.jsx(R,{className:"text-sm text-gray-500",children:"Response:"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono",children:`{
  "sub": "user123",
  "email": "user@example.com",
  "preferred_username": "user123",
  "nickname": "User Name",
  "avatar_url": "..."
}`})]}),e.jsx(R,{className:"text-sm text-gray-500",children:"Token Response (Success):"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono",children:`{
  "access_token": "...",
  "token_type": "Bearer",
  "expires_in": 3600
}`})]})}function Wn({app:t}){const{message:n}=ae.useApp();let s=re.API_URL;s.endsWith("/")&&(s=s.slice(0,-1));const r=window.location.origin,[c,d]=a.useState(null),[m,o]=a.useState(""),[i,u]=a.useState(null),x=async()=>{d(null),u(null),o("Initiating...");try{const{data:h}=await M.post("/oauth2/devicecode",new URLSearchParams({client_id:t.id}));d(h),o("Waiting for user authorization..."),n.success("Session initiated")}catch(h){const g=h.response?.data?.error||"Failed";o("Failed: "+g)}};return a.useEffect(()=>{if(!c||i)return;let h;const l=(c.interval||5)*1e3,g=async()=>{try{const{data:y}=await M.post("/oauth2/token",new URLSearchParams({client_id:t.id,device_code:c.device_code,grant_type:"urn:ietf:params:oauth:grant-type:device_code"}));u(y),o("Success! Token received."),n.success("Token received!"),d(null)}catch(y){const p=y.response?.data?.error;p==="authorization_pending"?h=setTimeout(g,l):p==="slow_down"?(o("Slowing down..."),h=setTimeout(g,l+5e3)):(o("Failed or Expired: "+(p||"Unknown")),d(null))}};return h=setTimeout(g,l),()=>clearTimeout(h)},[c,i,t.id]),e.jsxs("div",{className:"max-w-3xl space-y-8",children:[e.jsxs("div",{children:[e.jsx(ce,{title:"Suitable for CLI / Limited Input Devices",description:"Device Flow allows users to sign in on a secondary device using a short code or link. Only use this if your app cannot securely handle redirects or has limited input capabilities. Turned off by default for security reasons, enable in security tab if needed.",type:"info",showIcon:!0}),e.jsxs(G,{orientation:"vertical",className:"w-full bg-gray-50 dark:bg-gray-900/20 p-4 rounded border border-gray-200 dark:border-gray-700 mt-4",children:[e.jsx(X,{level:4,children:"Test Device Code Flow"}),e.jsx(U,{onClick:x,type:"primary",children:"Create test session"}),m&&e.jsxs("div",{className:"mt-4",children:[e.jsx(b,{strong:!0,children:"Status: "})," ",e.jsx(b,{children:m})]}),c&&e.jsxs("div",{className:"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-100 dark:border-blue-900",children:[e.jsxs(R,{className:"mb-1",children:["User Code:"," ",e.jsx(b,{copyable:!0,strong:!0,code:!0,children:c.user_code})]}),e.jsxs(R,{className:"mb-0",children:["Input the above code at:"," ",e.jsx("a",{href:c.verification_uri,target:"_blank",rel:"noopener noreferrer",children:c.verification_uri})]}),e.jsxs(R,{className:"mb-0",children:["Or visit:"," ",e.jsx("a",{href:c.verification_uri_complete,target:"_blank",rel:"noopener noreferrer",children:c.verification_uri_complete})]})]}),i&&e.jsxs("div",{className:"mt-2 bg-green-50 dark:bg-green-900/20 p-4 rounded border border-green-200",children:[e.jsx(b,{strong:!0,className:"text-green-600",children:"Access Token:"}),e.jsx(R,{className:"break-all font-mono text-xs",children:i.access_token}),i.refresh_token&&e.jsxs(e.Fragment,{children:[e.jsx(b,{strong:!0,className:"text-green-600",children:"Refresh Token:"}),e.jsx(R,{className:"break-all font-mono text-xs",children:i.refresh_token})]})]})]})]}),e.jsxs("div",{children:[e.jsx(X,{level:4,children:"1. Initiate Device Code Flow"}),e.jsx(R,{children:"Make a POST request to initiate the flow."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"POST"})," ",s,"/oauth2/devicecode",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"Content-Type:"})," application/x-www-form-urlencoded",e.jsx("br",{}),e.jsx("br",{}),"client_id=",t.id]}),e.jsx(R,{className:"mt-2 text-sm text-gray-500",children:"Response:"}),e.jsx("div",{className:"mt-2 bg-gray-100 dark:bg-gray-800 p-3 rounded text-sm text-gray-600 dark:text-gray-300 font-mono",children:`{
  "device_code": "...",
  "user_code": "WDJBMJHT",
  "verification_uri": "${r}/auth",
  "verification_uri_complete": "${r}/auth?user_code=WDJBMJHT",
  "expires_in": 900,
  "interval": 5
}`})]}),e.jsxs("div",{children:[e.jsx(X,{level:4,children:"2. Poll for Token"}),e.jsx(R,{children:"Poll the token endpoint using the `device_code` until the user authorizes."}),e.jsxs("div",{className:"bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed",children:[e.jsx("span",{className:"text-purple-400",children:"POST"})," ",s,"/oauth2/token",e.jsx("br",{}),e.jsx("span",{className:"text-blue-300",children:"Content-Type:"})," application/x-www-form-urlencoded",e.jsx("br",{}),e.jsx("br",{}),"client_id=",t.id,e.jsx("br",{}),"&device_code=...",e.jsx("br",{}),"&grant_type=urn:ietf:params:oauth:grant-type:device_code"]}),e.jsx(R,{className:"mt-2 text-sm text-gray-500",children:"Response (Pending):"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono mb-2",children:'{ "error": "authorization_pending" }'}),e.jsx(R,{className:"text-sm text-gray-500",children:"Response (Success):"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono",children:`{
  "access_token": "...",
  "token_type": "Bearer",
  "expires_in": 3600
}`})]})]})}function Vn({app:t}){const[n,s]=a.useState(null),[r,c]=a.useState([]),[d,m]=a.useState(!1),[o,i]=a.useState(null);a.useEffect(()=>{u()},[t.id]),a.useEffect(()=>{x(o)},[o,t.id]);const u=async()=>{m(!0);try{const{data:l}=await M.get(`/apps/stats?id=${t.id}`);s(l.data)}catch{}finally{m(!1)}},x=async l=>{let g=`/apps/history?id=${t.id}`;l&&(g+=`&date=${Ht(l)}&offset=${l.utcOffset()}`);try{const{data:y}=await M.get(g);c(y.data||[])}catch{}},h=a.useMemo(()=>n?.daily?n.daily:[],[n]);return d&&!n?e.jsx("div",{className:"p-4",children:"Loading stats..."}):n?e.jsxs("div",{children:[e.jsx(ie,{title:"Summary",className:"bg-white/90",style:{margin:"10px 0"},children:e.jsxs(Fe,{gutter:16,className:"text-center",children:[e.jsx(ne,{xs:12,sm:6,children:e.jsx(te,{title:"Total Users",value:n.totalUsers})}),e.jsx(ne,{xs:12,sm:6,children:e.jsx(te,{title:"Total Logins",value:n.totalLogins})}),e.jsx(ne,{xs:12,sm:6,children:e.jsx(te,{title:"Active (24h)",value:n.activeUsers24h})}),e.jsx(ne,{xs:12,sm:6,children:e.jsx(te,{title:"New (24h)",value:n.newUsers24h})})]})}),e.jsxs(Fe,{gutter:16,children:[e.jsx(ne,{xs:24,xl:12,children:e.jsx(ie,{title:"Traffic",style:{margin:"10px 0"},extra:e.jsx(b,{type:"secondary",children:"Days split by UTC"}),children:e.jsxs("div",{children:[e.jsx("div",{className:"flex items-end justify-between h-56 gap-2 px-2",children:h.map(l=>{const g=Math.max(...h.map(p=>Math.max(p.logins,p.activeUsers,p.newUsers))),y=g>0?160/g:0;return e.jsxs("div",{className:"flex flex-col items-center gap-2 group w-full overflow-hidden",children:[e.jsxs("div",{className:"flex gap-1 items-end h-[160px] w-full justify-center relative",children:[e.jsx("div",{className:"bg-indigo-400 dark:bg-indigo-600 w-3 rounded-t transition-all hover:bg-indigo-300",style:{height:`${Math.max(l.logins*y,4)}px`},title:`Logins: ${l.logins}`}),e.jsx("div",{className:"bg-emerald-400 dark:bg-emerald-600 w-3 rounded-t transition-all hover:bg-emerald-300",style:{height:`${Math.max(l.activeUsers*y,4)}px`},title:`Active Users: ${l.activeUsers}`}),e.jsx("div",{className:"bg-sky-400 dark:bg-sky-600 w-3 rounded-t transition-all hover:bg-sky-300",style:{height:`${Math.max(l.newUsers*y,4)}px`},title:`New Users: ${l.newUsers}`})]}),e.jsx("div",{className:"text-xs text-gray-500 whitespace-nowrap transform -rotate-45 origin-left mt-6 pl-4",children:Ce.utc(l.date).format("MM-DD")})]},l.date)})}),e.jsxs("div",{className:"flex justify-center flex-wrap gap-x-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-indigo-400 rounded"}),e.jsx(b,{type:"secondary",className:"text-xs",children:"Logins"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-emerald-400 rounded"}),e.jsx(b,{type:"secondary",className:"text-xs",children:"Active Users"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-sky-400 rounded"}),e.jsx(b,{type:"secondary",className:"text-xs",children:"New Users"})]})]})]})})}),e.jsx(ne,{xs:24,xl:12,children:e.jsxs(ie,{title:"Login History",style:{margin:"10px 0"},extra:e.jsx(Bt,{value:o,onChange:l=>i(l?l.utc():null),allowClear:!0}),children:[o&&e.jsxs(b,{children:[r.length," activities found"]}),e.jsx(pe,{dataSource:r,size:"small",pagination:{pageSize:10},locale:{emptyText:"No activity on selected date"},columns:[{title:"User",dataIndex:"user",key:"user",render:l=>l?e.jsx("span",{className:"flex items-center gap-2",children:l}):e.jsx(b,{type:"secondary",children:"Unknown"})},{title:"Time",dataIndex:"time",key:"time",render:l=>oe(l)}],rowKey:l=>l.time+(l.user||"unknown")})]})})]})]}):e.jsx("div",{className:"p-4",children:"No stats available."})}export{rs as default};
