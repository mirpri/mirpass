import{d as f,A as j,r as o,j as e,B as g,L as y,c as b}from"./index-BKXXxgCf.js";import{s as k}from"./crypto-B9Mf35RN.js";import{F as s,I as n}from"./index-CTdsIYHB.js";import{C as N}from"./index-_VEoIbwv.js";import{S as i}from"./TextArea-BkMGyXgq.js";import{T as P}from"./index-Bj67LGUl.js";import{R as v,a as F}from"./UserOutlined-Dtm1Go1D.js";const I=[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]],L=f("mail-check",I),{Title:l,Text:c}=P;function B(){const{message:a}=j.useApp(),[m,r]=o.useState(!1),[d]=s.useForm(),[p,u]=o.useState(!1),h=async t=>{r(!0);try{await b.post("/profile/password/reset",{username:t.username,newPassword:await k(t.newPassword)}),u(!0),a.success("A verification email has been sent")}catch(x){const w=x;a.error(w.response?.data?.error||"Failed to reset password")}finally{r(!1)}};return e.jsx(N,{className:"w-full max-w-md shadow-xl",children:e.jsxs(i,{orientation:"vertical",size:"large",className:"w-full",children:[p?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx(L,{size:100,className:"m-auto"})}),e.jsx(l,{level:4,children:"Check your email"}),e.jsx(c,{className:"block",children:"We've sent a confirmation link to the email address associated with that username. Please check your inbox (and spam folder) to complete the reset process."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center",children:[e.jsx(l,{level:3,children:"Forget Password"}),e.jsx(c,{type:"secondary",children:"Enter your username and new password."})]}),e.jsxs(s,{form:d,layout:"vertical",onFinish:h,requiredMark:!1,children:[e.jsx(s.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter your username"}],children:e.jsx(n,{prefix:e.jsx(v,{}),placeholder:"mirpass_user",size:"large"})}),e.jsx(s.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter a new password"},{min:8,message:"Password must be at least 8 characters"}],children:e.jsx(n.Password,{prefix:e.jsx(F,{}),placeholder:"New strong password",size:"large"})}),e.jsx(g,{type:"primary",htmlType:"submit",size:"large",block:!0,loading:m,style:{marginTop:"20px"},children:"Reset Password"})]})]}),e.jsx("div",{className:"text-center",children:e.jsx(y,{to:"/login",className:"text-gray-500 hover:text-blue-500",children:e.jsx(i,{children:"Back to Login"})})})]})})}export{B as default};
